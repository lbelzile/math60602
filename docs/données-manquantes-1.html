<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 7 Données manquantes | Analyse multidimensionnelle appliquée</title>
  <meta name="description" content="Recueil de notes pour MATH 60602 Analyse multidimensionnelle appliquée, avec des exemples d’applications en SAS et en R." />
  <meta name="generator" content="bookdown 0.21.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 7 Données manquantes | Analyse multidimensionnelle appliquée" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Recueil de notes pour MATH 60602 Analyse multidimensionnelle appliquée, avec des exemples d’applications en SAS et en R." />
  <meta name="github-repo" content="lbelzile/math60602" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 7 Données manquantes | Analyse multidimensionnelle appliquée" />
  
  <meta name="twitter:description" content="Recueil de notes pour MATH 60602 Analyse multidimensionnelle appliquée, avec des exemples d’applications en SAS et en R." />
  

<meta name="author" content="(c) Denis Larocque, Léo Belzile" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analyse-survie.html"/>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />




<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Analyse multidimensionnelle appliquée</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#survol-du-cours"><i class="fa fa-check"></i><b>1.1</b> Survol du cours</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#analyse-exploratoire"><i class="fa fa-check"></i><b>1.2</b> Analyse exploratoire de données</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html"><i class="fa fa-check"></i><b>2</b> Analyse factorielle exploratoire</a>
<ul>
<li class="chapter" data-level="2.1" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html#rappels-sur-le-coefficient-de-corrélation-linéaire"><i class="fa fa-check"></i><b>2.2</b> Rappels sur le coefficient de corrélation linéaire</a></li>
<li class="chapter" data-level="2.3" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html#exemple-de-questionnaire"><i class="fa fa-check"></i><b>2.3</b> Exemple de questionnaire</a></li>
<li class="chapter" data-level="2.4" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html#description-du-modèle-danalyse-factorielle"><i class="fa fa-check"></i><b>2.4</b> Description du modèle d’analyse factorielle</a></li>
<li class="chapter" data-level="2.5" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html#estimation-des-facteurs"><i class="fa fa-check"></i><b>2.5</b> Estimation des facteurs</a></li>
<li class="chapter" data-level="2.6" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html#choix-du-nombre-de-facteurs"><i class="fa fa-check"></i><b>2.6</b> Choix du nombre de facteurs</a></li>
<li class="chapter" data-level="2.7" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html#construction-déchelles-à-partir-des-facteurs"><i class="fa fa-check"></i><b>2.7</b> Construction d’échelles à partir des facteurs</a></li>
<li class="chapter" data-level="2.8" data-path="analyse-factorielle.html"><a href="analyse-factorielle.html#compléments-dinformation"><i class="fa fa-check"></i><b>2.8</b> Compléments d’information</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html"><i class="fa fa-check"></i><b>3</b> Analyse de regroupements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#segmentation-de-seniors-en-voyage-organisé"><i class="fa fa-check"></i><b>3.2</b> Segmentation de seniors en voyage organisé</a></li>
<li class="chapter" data-level="3.3" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#exploration-graphique-préalable-et-analyse-en-composantes-principales"><i class="fa fa-check"></i><b>3.3</b> Exploration graphique préalable et analyse en composantes principales</a></li>
<li class="chapter" data-level="3.4" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#méthodes-hiérarchiques"><i class="fa fa-check"></i><b>3.4</b> Méthodes hiérarchiques</a></li>
<li class="chapter" data-level="3.5" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#calcul-alternatif-des-distances-pour-le-regroupement-hiérarchique"><i class="fa fa-check"></i><b>3.5</b> Calcul alternatif des distances pour le regroupement hiérarchique</a></li>
<li class="chapter" data-level="3.6" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#autres-mesures-de-dissemblance"><i class="fa fa-check"></i><b>3.6</b> Autres mesures de dissemblance</a></li>
<li class="chapter" data-level="3.7" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#méthodes-non-hiérarchiques"><i class="fa fa-check"></i><b>3.7</b> Méthodes non hiérarchiques</a></li>
<li class="chapter" data-level="3.8" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#standardisation-des-variables"><i class="fa fa-check"></i><b>3.8</b> Standardisation des variables</a></li>
<li class="chapter" data-level="3.9" data-path="analyse-regroupements.html"><a href="analyse-regroupements.html#considérations-pratiques"><i class="fa fa-check"></i><b>3.9</b> Considérations pratiques</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="selection-modele.html"><a href="selection-modele.html"><i class="fa fa-check"></i><b>4</b> Sélection de variables et de modèles</a>
<ul>
<li class="chapter" data-level="4.1" data-path="selection-modele.html"><a href="selection-modele.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="selection-modele.html"><a href="selection-modele.html#sélection-de-variables-et-de-modèles-selon-les-buts-de-létude"><i class="fa fa-check"></i><b>4.2</b> Sélection de variables et de modèles selon les buts de l’étude</a></li>
<li class="chapter" data-level="4.3" data-path="selection-modele.html"><a href="selection-modele.html#mieux-vaut-plus-que-moins"><i class="fa fa-check"></i><b>4.3</b> Mieux vaut plus que moins</a></li>
<li class="chapter" data-level="4.4" data-path="selection-modele.html"><a href="selection-modele.html#trop-beau-pour-être-vrai"><i class="fa fa-check"></i><b>4.4</b> Trop beau pour être vrai</a></li>
<li class="chapter" data-level="4.5" data-path="selection-modele.html"><a href="selection-modele.html#principes-généraux"><i class="fa fa-check"></i><b>4.5</b> Principes généraux</a></li>
<li class="chapter" data-level="4.6" data-path="selection-modele.html"><a href="selection-modele.html#critères-dinformation"><i class="fa fa-check"></i><b>4.6</b> Critères d’information</a></li>
<li class="chapter" data-level="4.7" data-path="selection-modele.html"><a href="selection-modele.html#division-de-léchantillon-et-validation-croisée"><i class="fa fa-check"></i><b>4.7</b> Division de l’échantillon et validation croisée</a></li>
<li class="chapter" data-level="4.8" data-path="selection-modele.html"><a href="selection-modele.html#cibler-les-clients-pour-lenvoi-dun-catalogue"><i class="fa fa-check"></i><b>4.8</b> Cibler les clients pour l’envoi d’un catalogue</a></li>
<li class="chapter" data-level="4.9" data-path="selection-modele.html"><a href="selection-modele.html#recherche-automatique-du-meilleur-modèle"><i class="fa fa-check"></i><b>4.9</b> Recherche automatique du meilleur modèle</a></li>
<li class="chapter" data-level="4.10" data-path="selection-modele.html"><a href="selection-modele.html#recherche-automatique-de-tous-les-sous-ensembles"><i class="fa fa-check"></i><b>4.10</b> Recherche automatique de tous les sous-ensembles</a></li>
<li class="chapter" data-level="4.11" data-path="selection-modele.html"><a href="selection-modele.html#méthodes-classiques-de-sélection"><i class="fa fa-check"></i><b>4.11</b> Méthodes classiques de sélection</a></li>
<li class="chapter" data-level="4.12" data-path="selection-modele.html"><a href="selection-modele.html#recherche-séquentielle-automatique-limitée"><i class="fa fa-check"></i><b>4.12</b> Recherche séquentielle automatique limitée</a></li>
<li class="chapter" data-level="4.13" data-path="selection-modele.html"><a href="selection-modele.html#moyenne-de-modèles"><i class="fa fa-check"></i><b>4.13</b> Moyenne de modèles</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regression-logistique.html"><a href="regression-logistique.html"><i class="fa fa-check"></i><b>5</b> Régression logistique</a>
<ul>
<li class="chapter" data-level="5.1" data-path="regression-logistique.html"><a href="regression-logistique.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="regression-logistique.html"><a href="regression-logistique.html#modèle-de-régression-logistique"><i class="fa fa-check"></i><b>5.2</b> Modèle de régression logistique</a></li>
<li class="chapter" data-level="5.3" data-path="regression-logistique.html"><a href="regression-logistique.html#estimation-des-paramètres"><i class="fa fa-check"></i><b>5.3</b> Estimation des paramètres</a></li>
<li class="chapter" data-level="5.4" data-path="regression-logistique.html"><a href="regression-logistique.html#cowboy"><i class="fa fa-check"></i><b>5.4</b> Exemple du <em>Professional Rodeo Cowboys Association</em></a></li>
<li class="chapter" data-level="5.5" data-path="regression-logistique.html"><a href="regression-logistique.html#classification-et-prédiction-à-laide-de-la-régression-logistique"><i class="fa fa-check"></i><b>5.5</b> Classification et prédiction à l’aide de la régression logistique</a></li>
<li class="chapter" data-level="5.6" data-path="regression-logistique.html"><a href="regression-logistique.html#classification-avec-une-matrice-de-gain"><i class="fa fa-check"></i><b>5.6</b> Classification avec une matrice de gain</a></li>
<li class="chapter" data-level="5.7" data-path="regression-logistique.html"><a href="regression-logistique.html#sélection-de-variables-en-régression-logistique"><i class="fa fa-check"></i><b>5.7</b> Sélection de variables en régression logistique</a></li>
<li class="chapter" data-level="5.8" data-path="regression-logistique.html"><a href="regression-logistique.html#performance-des-différents-modèles-pour-lexemple-des-clients-cibles"><i class="fa fa-check"></i><b>5.8</b> Performance des différents modèles pour l’exemple des clients cibles</a></li>
<li class="chapter" data-level="5.9" data-path="regression-logistique.html"><a href="regression-logistique.html#extensions-du-modèle-de-régression-logistique-à-plus-de-deux-catégories"><i class="fa fa-check"></i><b>5.9</b> Extensions du modèle de régression logistique à plus de deux catégories</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analyse-survie.html"><a href="analyse-survie.html"><i class="fa fa-check"></i><b>6</b> Analyse de survie</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analyse-survie.html"><a href="analyse-survie.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="analyse-survie.html"><a href="analyse-survie.html#fonctions-de-survie-et-de-risque"><i class="fa fa-check"></i><b>6.2</b> Fonctions de survie et de risque</a></li>
<li class="chapter" data-level="6.3" data-path="analyse-survie.html"><a href="analyse-survie.html#estimation-dune-courbe-de-survie-et-de-risque"><i class="fa fa-check"></i><b>6.3</b> Estimation d’une courbe de survie et de risque</a></li>
<li class="chapter" data-level="6.4" data-path="analyse-survie.html"><a href="analyse-survie.html#comparaison-de-deux-courbes-de-survie"><i class="fa fa-check"></i><b>6.4</b> Comparaison de deux courbes de survie</a></li>
<li class="chapter" data-level="6.5" data-path="analyse-survie.html"><a href="analyse-survie.html#modèle-à-risques-proportionnels-de-cox"><i class="fa fa-check"></i><b>6.5</b> Modèle à risques proportionnels de Cox</a></li>
<li class="chapter" data-level="6.6" data-path="analyse-survie.html"><a href="analyse-survie.html#extensions-du-modèle-de-cox"><i class="fa fa-check"></i><b>6.6</b> Extensions du modèle de Cox</a></li>
<li class="chapter" data-level="6.7" data-path="analyse-survie.html"><a href="analyse-survie.html#risques-non-proportionnels"><i class="fa fa-check"></i><b>6.7</b> Risques non proportionnels</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="données-manquantes-1.html"><a href="données-manquantes-1.html"><i class="fa fa-check"></i><b>7</b> Données manquantes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="données-manquantes-1.html"><a href="données-manquantes-1.html#terminologie"><i class="fa fa-check"></i><b>7.1</b> Terminologie</a></li>
<li class="chapter" data-level="7.2" data-path="données-manquantes-1.html"><a href="données-manquantes-1.html#quelques-méthodes"><i class="fa fa-check"></i><b>7.2</b> Quelques méthodes</a></li>
<li class="chapter" data-level="7.3" data-path="données-manquantes-1.html"><a href="données-manquantes-1.html#example-dapplication-de-limputation"><i class="fa fa-check"></i><b>7.3</b> Example d’application de l’imputation</a></li>
<li class="chapter" data-level="7.4" data-path="données-manquantes-1.html"><a href="données-manquantes-1.html#valeurs-manquantes-dans-un-contexte-de-prédiction"><i class="fa fa-check"></i><b>7.4</b> Valeurs manquantes dans un contexte de prédiction</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publié avec bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse multidimensionnelle appliquée</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="données-manquantes-1" class="section level1" number="7">
<h1><span class="header-section-number">Chapitre 7</span> Données manquantes</h1>
<p>Il arrive fréquemment d’avoir des valeurs manquantes dans notre échantillon. Ces valeurs peuvent être manquantes pour diverses raisons. Si on prélève nous-mêmes nos données, un répondant peut refuser de répondre à certaines questions. Si on acquiert nos données d’une source externe, les valeurs de certaines variables peuvent être manquantes directement dans le fichier obtenu. Si on ne prend pas en compte le méchanisme générant les valeurs manquantes, ces dernières peuvent également biaiser nos analyses. Le but de ce chapitre est de faire un bref survol de ce sujet.</p>
<div id="terminologie" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Terminologie</h2>
<p>Soit <span class="math inline">\(X\)</span> une variable pour laquelle des données sont manquantes. Voici la définition de trois processus de génération de données manquantes.</p>
<ol style="list-style-type: decimal">
<li>Les données manquantes de <span class="math inline">\(X\)</span> sont dites <strong>manquantes de façon complètement aléatoire</strong> (MCAR, de l’anglais <em>missing completely at random</em>) si la probabilité que la valeur de <span class="math inline">\(X\)</span> soit manquante ne dépend ni de la valeur de <span class="math inline">\(X\)</span> (qui n’est pas observée), ni des valeurs des autres variables.</li>
</ol>
<p>Le fait qu’une variable est manquante peut être relié au fait qu’une autre soit manquante. Des gens peuvent refuser systématiquement de répondre à deux questions dans un sondage. Dans ce cas, si la probabilité qu’une personne ne réponde pas ne dépend pas des valeurs de ces variables (et de toutes les autres), nous sommes encore dans le cas MCAR. Si par contre, la probabilité que les gens ne répondent pas à une question sur leur revenu augmente avec la valeur de ce revenu, alors nous ne sommes plus dans le cas MCAR.</p>
<p>Le cas MCAR peut se présenter par exemple si des questionnaires, ou des pages ont été égarés ou détruits par inadvertance (effacées du disque rigide, etc.) Si les questionnaires manquants constituent un sous-ensemble choisi au hasard de tous les questionnaires, alors le processus est MCAR. L’hypothèse que les données manquantes sont complètement aléatoires est en général considérée comme trop restrictive.</p>
<ol start="2" style="list-style-type: decimal">
<li>Les données manquantes de <span class="math inline">\(X\)</span> sont dites <strong>données manquantes de façon aléatoire</strong> (MAR, de l’anglais <em>missing at random</em>) si la probabilité que la valeur de <span class="math inline">\(X\)</span> soit manquante ne dépend pas de la valeur de <span class="math inline">\(X\)</span> (qui n’est pas observée) une fois qu’on a contrôlé pour les autres variables.</li>
</ol>
<p>Il est possible par exemple que les femmes refusent plus souvent que les hommes de répondre à une question (et donc, le processus n’est pas MCAR). Si pour les femmes, la probabilité que <span class="math inline">\(X\)</span> est manquante ne dépend pas de la valeur de <span class="math inline">\(X\)</span> et que pour les hommes, la probabilité que <span class="math inline">\(X\)</span> est manquante ne dépend pas de la valeur de <span class="math inline">\(X\)</span>, alors le processus est MAR. Les probabilités d’avoir une valeur manquante sont différentes pour les hommes et les femmes mais cette probabilité ne dépend pas de la valeur de <span class="math inline">\(X\)</span> elle-même. L’hypothèse MAR est donc plus faible que l’hypothèse MCAR.</p>
<ol start="3" style="list-style-type: decimal">
<li>Les données manquantes de <span class="math inline">\(X\)</span> sont dites <strong>manquantes de façon non-aléatoire</strong> (MNAR, de l’anglais <em>missing not at random</em>) si la probabilité que la valeur de <span class="math inline">\(X\)</span> soit manquante dépend de la valeur de <span class="math inline">\(X\)</span> elle-même.</li>
</ol>
<p>Par exemple, les gens qui ont un revenu élevé pourraient avoir plus de réticences à répondre à une question sur leur revenu. La méthode de traitement que nous allons voir dans ce chapitre, l’imputation multiple, est très générale et est valide dans le cas MAR (et donc aussi dans le cas MCAR). Le cas MNAR est beaucoup plus difficile à traiter et ne sera pas considéré ici.</p>
</div>
<div id="quelques-méthodes" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Quelques méthodes</h2>
<div id="cas-complets" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Cas complets</h3>
<p>La première idée naïve pour une analyse est de retirer les observations avec données manquantes pour conserver les cas complets (<em>listwise deletion</em>, ou <em>complete case analysis</em>).</p>
<p>Cette méthode consiste à garder seulement les observations qui n’ont aucune valeur manquante pour les variables utilisées dans l’analyse demandée. Dès qu’une variable est manquante, on enlève le sujet au complet. C’est la méthode utilisée par défaut dans la plupart des logiciels, dont <strong>SAS</strong>.</p>
<ul>
<li>Si le processus est MCAR, cette méthode est valide car l’échantillon utilisé est vraiment un sous-échantillon aléatoire de l’échantillon original. Par contre, ce n’est pas nécessairement la meilleure solution car on perd de la précision en utilisant moins d’observations.</li>
<li>Si le processus est seulement MAR ou MNAR, cette méthode produit généralement des estimations biaisées des paramètres.</li>
</ul>
<p>En général, l’approche des cas complet est la première étape d’une analyse afin d’obtenir des estimés initiaux que nous corrigerons pas d’autre méthode. Elle n’est vraiment utile que si la proportion d’observations manquantes est très faible et le processus est MCAR. Évidemment, la présence de valeurs manquantes mène à une diminution de la précision des estimateurs (caractérisée par une augmentation des erreurs-types) et à une plus faible puissance pour les tests d’hypothèse et donc ignorer l’information partielle (si seulement certaines valeurs des variables explicatives sont manquantes) est sous-optimal.</p>
</div>
<div id="imputation-simple" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Imputation simple</h3>
<p>La deuxième approche est l’<strong>imputation simple</strong>. L’idée ici est de ne pas enlever les observations avec des valeurs manquantes mais de remplacer ces valeurs par des valeurs raisonnables. Par exemple, on peut remplacer les valeurs manquantes d’une variable par la moyenne de cette variable dans notre échantillon. On peut aussi ajuster un modèle de régression avec cette variable comme variable dépendante et d’autres variables explicatives comme variables indépendantes et utiliser les valeurs prédites comme remplacement. Une fois que les valeurs manquantes ont été remplacées, on fait l’analyse avec toutes les observations.</p>
<p>Il existe d’autres façons d’imputer les valeurs manquantes mais le problème de toutes ces approches est que l’on ne tient pas compte du fait que des valeurs ont été remplacées et on fait comme si c’était de vraies observations. Cela va en général sous-évaluer la variabilité dans les données. Par conséquent, les écarts-type des paramètres estimés seront en général sous-estimés et l’inférence (tests et intervalles de confiance) ne sera pas valide.
Cette approche n’est donc <strong>pas recommandée</strong>.</p>
<p>Une manière de tenter de reproduire correctement la variabilité dans les données consiste à ajouter un terme aléatoire dans l’imputation. C’est ce que fait la méthode suivante, qui possédera l’avantage de corriger automatiquement les écarts-type des paramètres estimés.</p>
</div>
<div id="imputation-multiple" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Imputation multiple</h3>
<p>Cette méthode peut être appliquée dans à peu près n’importe quelle situation et permet d’ajuster les écarts-type des paramètres estimés. Elle peut être appliquée lorsque le processus est MAR (et donc aussi MCAR).</p>
<p>L’idée consiste à procéder à une imputation aléatoire, selon une certaine technique, pour obtenir un échantillon complet et à ajuster le modèle d’intérêt avec cet échantillon. On répète ce processus plusieurs fois et on combine les résultats obtenus.</p>
<p>L’estimation finale des paramètres du modèle est alors simplement la moyenne des estimations pour les différentes répétitions et on peut également obtenir une estimation des écarts-type des paramètres qui tient compte du processus d’imputation.</p>
<p>Plus précisément, supposons qu’on s’intéresse à un seul paramètre <span class="math inline">\(\theta\)</span> dans un modèle donné. Ce modèle pourrait être un modèle de régression linéaire, de régression logistique, etc. Le paramètre <span class="math inline">\(\theta\)</span> serait alors un des <span class="math inline">\(\boldsymbol{\beta}\)</span> du modèle.</p>
<p>Supposons qu’on procède à <span class="math inline">\(K\)</span> imputations, c’est-à-dire, qu’on construit <span class="math inline">\(K\)</span> ensemble de données complets à partir de l’ensemble de données initial contenant des valeurs manquantes. On estime alors les paramètres du modèle séparément pour chacun des ensembles de données imputés. Soit <span class="math inline">\(\widehat{\theta}_k\)</span>, l’estimé du paramètre <span class="math inline">\(\theta\)</span> pour l’échantillon <span class="math inline">\(k \in \{1, \ldots, K\}\)</span> et <span class="math inline">\(\widehat{\sigma}_k^2={\mathsf{Var}}\left(\widehat{\theta}_k\right)\)</span> l’estimé de la variance de <span class="math inline">\(\widehat{\theta}_k\)</span> produite par le modèle estimé.</p>
<p>L’estimation finale de <span class="math inline">\(\theta\)</span>, dénotée <span class="math inline">\(\widehat{\theta}\)</span>, est obtenue tout simplement en faisant la moyenne des estimations de tous les modèles, c’est-à-dire,
<span class="math display">\[\begin{align*}
\widehat{\theta} = \frac{\widehat{\theta}_1 + \cdots + \widehat{\theta}_K}{K}.
\end{align*}\]</span>
Une estimation ajustée de la variance de <span class="math inline">\(\widehat{\theta}\)</span> est
<span class="math display">\[\begin{align*}
{\mathsf{Var}}\left(\hat{\theta}\right) &amp;= W+ \frac{K+1}{K}B, 
\\ W &amp;= \frac{1}{K} \sum_{k=1}^K \widehat{\sigma}^2_k = \frac{\widehat{\sigma}_1^2 + \cdots + \widehat{\sigma}_K^2}{K},\\
B &amp;= \frac{1}{K-1} \sum_{k=1}^K (\widehat{\theta}_k - \widehat{\theta})^2.
\end{align*}\]</span>
Ainsi, le terme <span class="math inline">\(W\)</span> est la moyenne des variances et <span class="math inline">\(B\)</span> est la variance entre les imputations. Le terme <span class="math inline">\((1+1/K)B\)</span> est celui qui vient corriger le fait qu’on travaille avec des données imputées et non pas des vraies données en augmentant la variance estimée du paramètre.</p>
<p>C’est ici qu’on voit l’intérêt à procéder à de l’imputation multiple. Si on procédait à une seule imputation (même en ajoutant une part d’aléatoire pour essayer de reproduire la variabilité des données), on ne serait pas en mesure d’estimer la variance inter-groupe de l’estimateur. Notez que la formule présentée n’est valide que pour le cas unidimensionnel; l’estimation de la variance dans le cas multidimensionnel est différente (voir Little et Rubin, 2002).</p>
<p>Les procédures <code>mi</code> et <code>mianalyze</code> de <strong>SAS</strong> permettent d’effectuer de l’imputation multiple et d’obtenir des estimations valides des paramètres et de leurs écarts-type pour à peu près n’importe quel modèle. Plus spécifiquement, la procédure <code>mi</code> permet d’examiner la configuration des valeurs manquantes et de procéder à l’imputation. De son côté, la procédure <code>mianalyze</code> permet de combiner les résultats des estimations provenant des échantillons combinés afin d’obtenir les estimations finales. La structure habituelle du code <strong>SAS</strong> est la suivante:</p>
<ol style="list-style-type: decimal">
<li>procédure <code>mi</code> pour obtenir des échantillons imputés.</li>
<li>procédure quelconque pour ajuster le modèle voulu (par exemple, <code>proc reg</code> ou <code>proc logistic</code>). Il faut ajuster les modèles séparément pour chaque échantillon imputé avec la commande <code>by</code>.</li>
<li>procédure <code>mianalyze</code> pour combiner les résultats.</li>
</ol>
<p>La méthode d’imputation multiple possède l’avantage d’être applicable avec n’importe quel modèle sous-jacent. Une fois qu’on a des échantillons complets (imputés), on ajuste le modèle comme d’habitude. Mais une observation imputée ne remplacera jamais une vraie observation. Il faut donc faire tout ce qu’on peut pour limiter le plus possible les données manquantes.</p>
<p>Il faut utiliser son jugement. Par exemple, si la proportion d’observations perdues est petite (moins de 5%), ça ne vaut peut-être pas la peine de prendre des mesures particulières et on peut faire une analyse avec les données complètes seulement. S’il y a un doute, on peut faire une analyse avec les données complètes seulement et une autre avec imputations multiples afin de valider la première.</p>
<p>Si, à l’inverse, une variable secondaire cause à elle seule une grande proportion de valeurs manquantes, on peut alors considérer l’éliminer afin de récupérer des observations. Par exemple, si vous avez une proportion de 30% de valeurs manquantes en utilisant toutes vos variables et que cette proportion baisse à 3% lorsque vous éliminez quelques variables peu importantes pour votre étude (ou qui peuvent être remplacées par d’autres jouant à peu près le même rôle qui elles sont disponibles), alors vous pourriez considérer la possibilité de les éliminer. Il est donc nécessaire d’examiner la configuration des valeurs manquantes avant de faire quoi que ce soit. La procédure <code>mi</code> permet de faire cela, comme nous le verrons dans l’exemple qui suit.</p>
</div>
</div>
<div id="example-dapplication-de-limputation" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Example d’application de l’imputation</h2>
<p>On examine l’exemple de recommandations de l’association professionnelle des vachers de la section <a href="regression-logistique.html#cowboy">5.4</a>.</p>
<p>Le but est d’examiner les effets des variables <span class="math inline">\(X_1\)</span> à <span class="math inline">\(X_6\)</span> sur les intentions d’achat (<span class="math inline">\(Y\)</span>); la base de données <code>missing1.sas7bdat</code> contient les observations et les commandes <strong>SAS</strong> se trouvent dans le fichier <code>missing1.sas</code>. Il s’agit des mêmes données que celles du fichier <code>logit1.sas7bdat</code> mais avec des valeurs manquantes.</p>
<table>
<caption>
<span id="tab:missing1r">Tableau 7.1: </span>Tableau des configurations des données manquantes.
</caption>
<thead>
<tr>
<th style="text-align:right;">
<span class="math inline">\(X_1\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(X_2\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(X_3\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(X_4\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(X_5\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(X_6\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(y\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Les points (<code>.</code>) indiquent des valeurs manquantes. Le premier sujet n’a pas de valeur manquante. Le deuxième a une valeur manquante pour <span class="math inline">\(X_1\)</span> (emploi) et <span class="math inline">\(X_4\)</span> (éducation), etc.</p>
<p>Une première façon de voir combien il y a de valeurs manquantes consiste à faire sortir les statistiques descriptives avec la procédure <code>means</code>.
Ainsi, il y 192 valeurs manquantes pour <span class="math inline">\(X_1\)</span>, 48 pour <span class="math inline">\(X_2\)</span> et 184 pour <span class="math inline">\(X_4\)</span>. Les autres variables n’ont pas de valeurs manquantes, incluant la variable dépendante <span class="math inline">\(Y\)</span>. La procédure unidimensionnelle nous permet seulement de voir combien il y a de valeurs manquantes variable par variable, séparément.</p>
<p><img src="figures/06-manquantes-e1.png" width="35%" style="display: block; margin: auto;" /></p>
<p>Afin d’avoir plus d’information au sujet de la configuration des valeurs manquantes, on peut utiliser la procédure <code>mi</code>. Comme on veut seulement voir comment sont distribuées les valeurs manquantes et non pas imputer les valeurs manquantes, on fixe <code>nimpute=0</code>.</p>
<pre class="sas"><code>proc mi data=multi.missing1 nimpute=0;
var y x1-x6;
run;</code></pre>
<p><img src="figures/06-manquantes-e2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Dans la partie de gauche, les <code>X</code> indiquent que la variable est présente dans cette configuration et le point indique qu’elle est manquante. Ainsi, il y a 180 sujets (36% de l’échantillon) avec aucune observation manquante. Il y en a 99 avec seulement <span class="math inline">\(X_4\)</span> manquante et ainsi de suite. On voit donc, par exemple, que pour 14 sujets, à la fois <span class="math inline">\(X_1\)</span> et <span class="math inline">\(X_2\)</span> sont manquantes. La partie de droite donne la moyenne des variables dans chaque configuration.</p>
<p>La recommandation d’usage est d’imputer au moins le pourcentage de cas incomplet, ici 72% donc 72 imputations. Si la procédure est trop gloutonne en calcul, on peut diminuer le nombre d’imputations, mais au moins cinq ou 10 réplications sont de mise.</p>
<p>On peut comparer l’inférence avec toutes les variables explicatives pour les données sans valeurs manquantes (<span class="math inline">\(n=500\)</span> observations), avec les cas complets uniquement (<span class="math inline">\(n=180\)</span> observations).
Le Tableau <a href="données-manquantes-1.html#tab:missing3r">7.2</a> présente les estimations des paramètres du modèle de régression logistique s’il n’y avait pas eu de valeurs manquantes, avec les cas complets et les résultats de l’imputation multiple.</p>
<p>Revenons à présent à notre fichier avec des valeurs manquantes. Si on demande à <strong>SAS</strong> d’ajuster le modèle de régression logistique, il va par défaut retirer les observations qui ont au moins une valeur manquante pour une des variables nécessaires à l’analyse. Ainsi, le modèle va être ajusté avec seulement 180 observations. Cette analyse est présentée seulement pour montrer l’effet des valeurs manquantes.</p>
<p>Ceci est clairement indiqué dans la partie de la sortie qui est reproduite ci-après.</p>
<p><img src="figures/06-manquantes-e3.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Il ne serait pas raisonnable de faire l’analyse avec seulement 180 observations et de laisser tomber les 320 autres. De plus, comme nous l’avons vu plus haut, ce n’est pas valide à moins que le processus ne soit MCAR. La partie du milieu du Tableau <a href="données-manquantes-1.html#tab:missing3r">7.2</a> présente les estimations obtenues. On voit par exemple que la variable <span class="math inline">\(X_3\)</span> (sexe), qui était clairement significative lorsqu’il n’y avait pas de valeurs manquantes, est maintenant non-significative (valeur-<span class="math inline">\(p\)</span> de 0,068). La même chose est vraie pour quelques autres variables incluant <span class="math inline">\({\mathbf 1}_{X_6=2}\)</span>. Il y a même pire, non seulement la variable <span class="math inline">\({\mathbf 1}_{X_2=1}\)</span> est passée de significative à non significative, mais en plus l’estimé de son paramètre a changé de signe.</p>
<p>Nous allons donc faire l’analyse avec l’imputation multiple, en prenant la méthode d’imputation par défaut dans la procédure <code>mi</code>. Le code <strong>SAS</strong> est</p>
<pre class="sas"><code>proc mi data=multi.missing1 out=outmi 
    nimpute=pctmissing seed=746382643;
var x11 x12 x13 x14 x21 x22 x23 x24 x3 x4 x5 x61 x62;
run;

proc logistic data=outmi outest=outlogistic 
    covout descending noprint;
model y(ref=&#39;0&#39;) = x11 x12 x13 x14 x21 x22 x23 x24 x3 x4 x5 x61 x62;
by _imputation_;
run;

proc mianalyze data=outlogistic;
var intercept x11 x12 x13 x14 x21 x22 x23 x24 x3 x4 x5 x61 x62;
run;</code></pre>
<p>Avec la procédure <code>mi</code> on demande un nombre d’imputations égal au nombre de données manquantes, mais au moins cinq et au plus 50 (<code>nimpute=pctmissing</code>). Le fichier de sortie (<code>outmi</code>) va contenir ces <span class="math inline">\(m\)</span> ensembles de données pour un total de <span class="math inline">\(m \times 500\)</span>. Dans ce fichier, l’ensemble est identifié par la variable <code>_imputation_</code>, qui prend des valeurs de 1 à <span class="math inline">\(m\)</span>.</p>
<p>On estime pour chaque jeu de données un modèle de régression logistique grâce à la commande <code>by _imputation_</code>. Les paramètres estimés sont placés dans le fichier <code>outlogistic</code>. On sauvegarde aussi l’estimé de la matrice de variance des paramètres avec l’option <code>covout</code>.</p>
<p>Finalement, la procédure <code>mianalyze</code> est utilisée pour combiner les résultats de ces <span class="math inline">\(m\)</span> modèles et pour fournir les estimations finales des paramètres. Une partie de la sortie est présentée
<img src="figures/06-manquantes-e4.png" width="80%" style="display: block; margin: auto;" />
<img src="figures/06-manquantes-e5.png" width="100%" style="display: block; margin: auto;" /></p>
<table>
<caption>
<span id="tab:missing3r">Tableau 7.2: </span>Estimés, erreurs-type et valeurs-<span class="math inline">\(p\)</span> des paramètres, avec les 500 données complètes (gauche), avec les 180 cas complets (milieu) et imputation multiple (droite).
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\mathrm{se}(\widehat{\boldsymbol{\beta}})\)</span>
</th>
<th style="text-align:right;">
valeur-<span class="math inline">\(p\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\mathrm{se}(\widehat{\boldsymbol{\beta}})\)</span>
</th>
<th style="text-align:right;">
valeur-<span class="math inline">\(p\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\mathrm{se}(\widehat{\boldsymbol{\beta}})\)</span>
</th>
<th style="text-align:right;">
valeur-<span class="math inline">\(p\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
<span class="math inline">\(-6.888\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.022\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-5.251\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.700\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.002\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-6.575\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.037\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_1=1\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.358\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.483\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.458\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.086\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.850\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.919\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.546\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.540\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.312\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_1=2\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.468\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.371\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.208\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.568\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.656\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.387\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.125\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.446\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.779\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_1=3\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.311\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.350\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.374\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.471\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.658\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.474\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.072\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.436\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.869\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_1=4\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.317\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.402\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.431\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.926\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.738\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.210\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.043\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.485\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.930\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_2=1\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.331\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.597\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.026\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.735\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.144\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.521\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.098\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.647\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.090\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_2=2\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.148\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.501\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.022\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.460\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.908\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.613\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.032\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.545\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.059\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_2=3\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.773\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.483\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.109\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-0.409\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.886\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.644\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.524\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.520\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.314\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_2=4\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-1.109\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.542\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.041\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-2.741\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.020\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.007\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-1.043\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.568\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.066\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_3\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.349\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.260\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.802\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.440\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.068\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.190\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.268\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_4\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.830\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.298\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(2.254\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.578\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.516\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.372\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_5\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.109\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.019\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.107\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.033\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.001\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.104\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.019\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_6=1\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(2.412\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.376\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(2.233\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.665\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.001\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(2.261\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.380\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(x_6=2\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1.045\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.249\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.831\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.437\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.057\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.995\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.250\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0.000\)</span>
</td>
</tr>
</tbody>
</table>
<p>On peut remarquer que la précision est systématiquement meilleure avec l’imputation multiple; les erreurs-type pour l’imputation multiple sont plus petits que celle du modèleles erreurs-type sont plus petits qui retire les données incomplètes.</p>
<p>On voit que la variable <span class="math inline">\(X_3\)</span> (sexe) est significative avec l’imputation multiple. Son paramètre estimé est 1,202, comparativement à 1,349 s’il n’y avait pas eu de valeurs manquantes. La précision dans l’estimation avec l’imputation multiple est seulement un peu moins bonne (erreur-type de 0,282) que celle s’il n’y avait pas eu de manquantes (erreur type de 0,26). Le paramètre de <span class="math inline">\({\mathbf 1}_{X_6=2}\)</span> redevient aussi significatif, alors qu’il ne l’était plus si on retirait les manquantes. Il est peu probable que les données soit <span class="math inline">\(\mathsf{MCAR}\)</span> et donc les résultats de l’analyse des cas complets seraient biaisés.</p>
</div>
<div id="valeurs-manquantes-dans-un-contexte-de-prédiction" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Valeurs manquantes dans un contexte de prédiction</h2>
<p>Nous avons vu que l’imputation multiple permet de corriger les écarts-type des paramètres estimés afin d’obtenir une inférence valide. Mais cette fois-ci, le but n’est pas d’estimer un modèle afin de tester formellement certaines hypothèses, mais plutôt de développer un modèle pour obtenir des prédictions. Dans ce cas, l’imputation multiple peut aussi être utile.</p>
<p>Nous allons revenir une dernière fois sur l’exemple de ciblage de clients pour l’envoi d’un catalogue. Rappelez-vous qu’on a un échantillon d’apprentissage de 1000 clients pour lesquels la variable <span class="math inline">\(\texttt{yachat}\)</span> est disponible (est-ce que le client a acheté quelque chose lorsqu’on lui a envoyé un catalogue). Nous avons développé des modèles avec ces 1000 clients afin de décider à qui, parmi les 100 000 clients restants, envoyer le catalogue. Nous avions alors utilisé des données sans valeurs manquantes. Cette fois-ci, nous allons faire comme s’il y avait des valeurs manquantes pour les variables explicatives à la fois dans l’échantillon d’apprentissage mais aussi dans l’échantillon à prédire. Nous allons chercher à développer un modèle de régression logistique pour <span class="math inline">\({\mathsf P}\left(\texttt{yachat}=1\right)\)</span>. Plusieurs approches sont possibles et il n’est pas clair à priori laquelle est la meilleure. Voici la description de deux approches.</p>
<p><strong>Approche 1: </strong></p>
<ol style="list-style-type: decimal">
<li>Obtenir <span class="math inline">\(K\)</span> ensembles de données complets par imputations multiples (simultanément pour les échantillons tests et d’apprentissage).</li>
<li>Pour chaque ensemble de données complet,
<ol style="list-style-type: lower-alpha">
<li>Faire une sélection de variables</li>
<li>Obtenir les estimations de <span class="math inline">\({\mathsf P}\left(\texttt{yachat}=1\right)\)</span></li>
</ol></li>
<li>Pour chaque observation dans les deux échantillons faire la moyenne des <span class="math inline">\(K\)</span> estimations de <span class="math inline">\({\mathsf P}\left(\texttt{yachat}=1\right)\)</span> de manière à avoir une seule prédiction par observation de la probabilité d’achat.</li>
<li>Trouver le meilleur point de coupure avec les probabilités calculées en 3) pour l’échantillon d’apprentissage.</li>
<li>Assigner les observations de l’échantillon à prédire avec ce point de coupure en utilisant les probabilités calculées en 3) pour les données de l’échantillon test.</li>
</ol>
<p><strong>Approche 2:</strong></p>
<ol style="list-style-type: decimal">
<li>Obtenir <span class="math inline">\(K\)</span> ensembles de données complets par imputations multiples (simultanément pour les échantillons tests et d’apprentissage).</li>
<li>Pour chaque ensemble de données complet,
<ol style="list-style-type: lower-alpha">
<li>Faire une sélection de variables</li>
<li>Trouver le meilleur point de coupure par validation-croisée</li>
<li>Obtenir les prédictions (<span class="math inline">\(0\)</span> ou <span class="math inline">\(1\)</span>) pour l’échantillon à scorer, avec ce point de coupure.</li>
</ol></li>
<li>Assigner l’observation à la classe majoritaire (celle qui a le plus de votes parmi zéro ou un pour les <span class="math inline">\(K\)</span> prédictions) pour chaque observation à prédire.</li>
</ol>
<p>Nous allons seulement utiliser une approximation de la première approche ici et ignorer les valeurs de <span class="math inline">\(\texttt{yachat}\)</span> et <span class="math inline">\(\texttt{ymontant}\)</span> lors de l’imputation car ces dernières sont manquantes dans l’échantillon test et on se trouverait imputer à partir de modèles différentes dans les deux échantillons (test et apprentissage). Le code se trouve dans le fichier <code>missing2_prevision.sas</code> et les données dans <code>dbmmissing.sas7bdat</code>. Des informations sur les valeurs manquantes dans l’échantillon d’apprentissage peuvent être obtenues à l’aide des procédures <code>means</code> et <code>mi</code>. Il y a des valeurs manquantes dans chaque variable: par exemple, 99 valeurs manquantes pour <span class="math inline">\(X_1\)</span>. Globalement, seulement 201 des 1000 clients n’ont aucune valeur manquante sur les 10 variables. Il y a 164 configurations différentes de valeurs manquantes.</p>
<p>En utilisant l’approche 1 présentée plus haut, nous allons imputer simultanément les valeurs manquantes pour l’échantillon d’apprentissage et l’échantillon test à prédire avec <span class="math inline">\(K=5\)</span> échantillons imputés. La méthode de sélection de variables utilisée est la procédure séquentielle classique avec 0,05 comme critère d’entrée et de sortie. De plus, afin de simplifier le tout, le point de coupure a été fixé à 0,14 (celui que l’on avait obtenu dans le cas où il n’y a pas de valeurs manquantes) et non pas estimé par validation-croisée.</p>
<p>Il s’avère que le revenu net, sur les 100 000 clients restants, aurait été de 926 349$. S’il n’y avait pas eu de valeurs manquantes, la sélection basée sur une procédure séquentielle classique aurait généré un revenu net de 969 350$. Les données manquantes rendent plus difficile le développement du modèle. Mais on fait quand même encore beaucoup mieux que la stratégie de référence qui consiste à envoyer le catalogue aux 100 000 clients, qui aurait généré un revenu net de 601 112$.</p>

</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="analyse-survie.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MATH60602.pdf"],
"toc": {
"collapse": "section",
"split_by": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
