<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.309">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Cours MATH 60602 - Analyse multidimensionnelle appliquée à HEC Montréal.">

<title>MATH 60602 - Analyse multidimensionnelle appliquée - 4&nbsp; Analyse de regroupements</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<link href="./04-selectionmodeles.html" rel="next">
<link href="./02-analysefactorielle.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analyse de regroupements</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MATH 60602 - Analyse multidimensionnelle appliquée</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/lbelzile/math60602/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./MATH-60602---Analyse-multidimensionnelle-appliquée.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./MATH-60602---Analyse-multidimensionnelle-appliquée.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-analyseexploratoire.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analyse exploratoire de données</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-analysefactorielle.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Réduction de la dimension</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-regroupements.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analyse de regroupements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-selectionmodeles.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sélection de variables et de modèles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-reglogistique.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Régression logistique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-survie.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Analyse de survie</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-donneesmanquantes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Données manquantes</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"> <span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#présentation-des-données" id="toc-présentation-des-données" class="nav-link" data-scroll-target="#présentation-des-données"> <span class="header-section-number">4.2</span> Présentation des données</a></li>
  <li><a href="#analyse-exploratoire-graphique" id="toc-analyse-exploratoire-graphique" class="nav-link" data-scroll-target="#analyse-exploratoire-graphique"> <span class="header-section-number">4.3</span> Analyse exploratoire graphique</a></li>
  <li><a href="#choix-des-variables" id="toc-choix-des-variables" class="nav-link" data-scroll-target="#choix-des-variables"> <span class="header-section-number">4.4</span> Choix des variables</a>
  <ul class="collapse">
  <li><a href="#standardisation" id="toc-standardisation" class="nav-link" data-scroll-target="#standardisation"> <span class="header-section-number">4.4.1</span> Standardisation</a></li>
  </ul></li>
  <li><a href="#mesures-de-dissemblance-et-de-similarité" id="toc-mesures-de-dissemblance-et-de-similarité" class="nav-link" data-scroll-target="#mesures-de-dissemblance-et-de-similarité"> <span class="header-section-number">4.5</span> Mesures de dissemblance et de similarité</a>
  <ul class="collapse">
  <li><a href="#mesure-de-dissemblance" id="toc-mesure-de-dissemblance" class="nav-link" data-scroll-target="#mesure-de-dissemblance"> <span class="header-section-number">4.5.1</span> Mesure de dissemblance</a></li>
  <li><a href="#mesures-de-similarité" id="toc-mesures-de-similarité" class="nav-link" data-scroll-target="#mesures-de-similarité"> <span class="header-section-number">4.5.2</span> Mesures de similarité</a></li>
  </ul></li>
  <li><a href="#méthodes-de-regroupement" id="toc-méthodes-de-regroupement" class="nav-link" data-scroll-target="#méthodes-de-regroupement"> <span class="header-section-number">4.6</span> Méthodes de regroupement</a>
  <ul class="collapse">
  <li><a href="#k-moyennes" id="toc-k-moyennes" class="nav-link" data-scroll-target="#k-moyennes"> <span class="header-section-number">4.6.1</span> K-moyennes</a></li>
  <li><a href="#algorithm-dbscan" id="toc-algorithm-dbscan" class="nav-link" data-scroll-target="#algorithm-dbscan"> <span class="header-section-number">4.6.2</span> Algorithm DBSCAN</a></li>
  <li><a href="#mélanges-de-modèles" id="toc-mélanges-de-modèles" class="nav-link" data-scroll-target="#mélanges-de-modèles"> <span class="header-section-number">4.6.3</span> Mélanges de modèles</a></li>
  <li><a href="#regroupements-spectraux" id="toc-regroupements-spectraux" class="nav-link" data-scroll-target="#regroupements-spectraux"> <span class="header-section-number">4.6.4</span> Regroupements spectraux</a></li>
  </ul></li>
  <li><a href="#mesure-de-la-qualité-des-regroupements" id="toc-mesure-de-la-qualité-des-regroupements" class="nav-link" data-scroll-target="#mesure-de-la-qualité-des-regroupements"> <span class="header-section-number">4.7</span> Mesure de la qualité des regroupements</a>
  <ul class="collapse">
  <li><a href="#mesures-dadéquation" id="toc-mesures-dadéquation" class="nav-link" data-scroll-target="#mesures-dadéquation"> <span class="header-section-number">4.7.1</span> Mesures d’adéquation</a></li>
  <li><a href="#choix-des-hyperparamètres" id="toc-choix-des-hyperparamètres" class="nav-link" data-scroll-target="#choix-des-hyperparamètres"> <span class="header-section-number">4.7.2</span> Choix des hyperparamètres</a></li>
  <li><a href="#méthodes-hiérarchiques" id="toc-méthodes-hiérarchiques" class="nav-link" data-scroll-target="#méthodes-hiérarchiques"> <span class="header-section-number">4.7.3</span> Méthodes hiérarchiques</a></li>
  </ul></li>
  <li><a href="#méthodes-hiérarchiques-1" id="toc-méthodes-hiérarchiques-1" class="nav-link" data-scroll-target="#méthodes-hiérarchiques-1"> <span class="header-section-number">4.8</span> Méthodes hiérarchiques</a>
  <ul class="collapse">
  <li><a href="#méthode-de-ward" id="toc-méthode-de-ward" class="nav-link" data-scroll-target="#méthode-de-ward"> <span class="header-section-number">4.8.1</span> Méthode de Ward</a></li>
  </ul></li>
  <li><a href="#calcul-alternatif-des-distances-pour-le-regroupement-hiérarchique" id="toc-calcul-alternatif-des-distances-pour-le-regroupement-hiérarchique" class="nav-link" data-scroll-target="#calcul-alternatif-des-distances-pour-le-regroupement-hiérarchique"> <span class="header-section-number">4.9</span> Calcul alternatif des distances pour le regroupement hiérarchique</a></li>
  <li><a href="#méthodes-non-hiérarchiques" id="toc-méthodes-non-hiérarchiques" class="nav-link" data-scroll-target="#méthodes-non-hiérarchiques"> <span class="header-section-number">4.10</span> Méthodes non hiérarchiques</a></li>
  <li><a href="#considérations-pratiques" id="toc-considérations-pratiques" class="nav-link" data-scroll-target="#considérations-pratiques"> <span class="header-section-number">4.11</span> Considérations pratiques</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/lbelzile/math60602/edit/master/03-regroupements.qmd" class="toc-action">Éditer cette page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="analyse-regroupements" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analyse de regroupements</span></span></h1>
</div>

<div>
  <div class="description">
    <p>Cours MATH 60602 - Analyse multidimensionnelle appliquée à HEC Montréal.</p>
  </div>
</div>




<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="introduction" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">4.1</span> Introduction</h2>
<p>On cherche à créer des regroupements (<em>clusters</em>) d’individus homogènes en utilisant <span class="math inline">\(p\)</span> variables <span class="math inline">\(X_1, \ldots, X_p\)</span>. Plus précisément, on veut combiner des sujets en groupes (interprétables) de telle sorte que les individus d’un même groupe soient le plus semblables possible par rapport à certaines caractéristiques et que les groupes soient le plus différent possible.</p>
<p>Nous disposons des observations pour <span class="math inline">\(n\)</span> individus et <span class="math inline">\(X_{ij}\)</span> dénote la valeur de la <span class="math inline">\(j\)</span>e variable explicative pour le <span class="math inline">\(i\)</span>e sujet: les variables correspondant au <span class="math inline">\(i\)</span>e sujet <span class="math inline">\(S_i\)</span> sont donc <span class="math inline">\(X_{i1}, \ldots, X_{ip}\)</span>. Le résultat de l’analyse de regroupements sera une étiquette associée à chaque observation l’assignant à un regroupement ou l’identifiant comme aberrance.</p>
<p>Il y a une certaine analogie avec l’analyse factorielle. En analyse factorielle, on cherche à déterminer s’il y a des groupes de <strong>variables</strong> corrélées entre elles. On cherche donc à regrouper des variables. En analyse de regroupements, on cherche plutôt à créer des groupes de <strong>sujets</strong> similaires. Les deux méthodes servent pour l’analyse exploratoire.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Étapes d’une analyse de regroupements
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Choisir les variables pertinentes à l’analyse.</li>
<li>Décider comment seront mesurées les « distances » entre les sujets.</li>
<li>Décider quel algorithme ou modèle sera utilisé.</li>
<li>Choisir les hyperparamètres de l’algorithme (nombre de regroupements, rayon, etc.), qui déterminent la qualité de la segmentation.</li>
<li>Assigner les étiquettes aux observations et calculer un représentant-type de groupe. Interpréter les regroupements obtenus.</li>
<li>Utiliser ces groupes dans d’autres analyses, le cas échéant.</li>
</ol>
</div>
</div>
</section>
<section id="présentation-des-données" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="présentation-des-données"><span class="header-section-number">4.2</span> Présentation des données</h2>
<p>Les données sont inspirées d’un article traitant de la segmentation de seniors qui participent à des voyages organisés:</p>
<blockquote class="blockquote">
<p>Hsu, C. H. C. et Lee E.-J. (2002). Segmentation of Senior Motorcoach Travelers. <em>Journal of Travel Research</em>, <strong>40</strong>, 364-373.</p>
</blockquote>
<p>Les buts principaux de l’étude étaient</p>
<ol type="1">
<li>Regrouper les gens de 55 et plus qui participent à des voyages organisés en autobus en groupes homogènes selon des caractéristiques reliées au choix de l’opérateur et du voyage.</li>
<li>Examiner les caractéristiques démographiques de ces groupes.</li>
</ol>
<p>Un questionnaire a été élaboré afin d’évaluer l’importance de 55 caractéristiques des opérateurs de voyages organisés en autobus et des voyages eux-mêmes à l’aide d’une échelle de Likert à cinq points, allant de extrêmement important (<span class="math inline">\(\texttt{5}\)</span>) à pas important du tout (<span class="math inline">\(\texttt{1}\)</span>). Des données sont disponibles pour 150 sujets (il y en avait 817 dans l’article). Elles se trouvent dans la base de données <code>cluster</code>.</p>
<p>Au lieu de faire une analyse de regroupements avec les 55 items du questionnaire, les auteurs ont choisi de faire une analyse factorielle avec rotation varimax au préalable afin de réduire le nombre de variables à six facteurs interprétables :</p>
<ul>
<li>Activités sociales (<span class="math inline">\(X_1\)</span>): formé de cinq items</li>
<li>Politiques de l’opérateur et références (<span class="math inline">\(X_2\)</span>) : formé de six items.</li>
<li>Horaires flexibles (<span class="math inline">\(X_3\)</span>): formé de trois items.</li>
<li>Santé et sécurité (<span class="math inline">\(X_4\)</span>) : formé de quatre items.</li>
<li>Matériel publicitaire (<span class="math inline">\(X_5\)</span>): formé de deux items.</li>
<li>Réputation (<span class="math inline">\(X_6\)</span>): formé de deux items.</li>
</ul>
<p>On voit donc que 22 items, parmi les 55, sont utilisés dans la définition de ces six facteurs. Dans l’article, les auteurs ont décidé d’inclure ces 22 items dans l’analyse de regroupements. Pour notre part et afin de simplifier l’exemple, nous allons plutôt créer six nouvelles échelles en faisant la moyenne des items de chaque facteur ci-haut et utiliser seulement ces six échelles dans l’analyse de regroupements. Les valeurs de ces six variables pour les 150 sujets se trouvent dans le fichier <code>cluster.sas7bdat</code> et sont toutes dans l’intervalle [1, 5], puisqu’elles représentent la moyenne d’échelles de Likert. Le <a href="#tbl-statdescriptcluster">Tableau&nbsp;<span>4.1</span></a> présente les statistiques descriptives de la base de données.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-statdescriptcluster" class="anchored">
<table class="table" style="margin-left: auto; margin-right: auto;"><caption>Tableau 4.1:  Statistiques descriptives des six variables du jeu de données cluster. </caption>
 <thead>
  <tr>
   <th style="text-align:right;"> moyenne </th>
   <th style="text-align:right;"> écart-type </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:left;"> histogramme </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 2.93 </td>
   <td style="text-align:right;"> 1.14 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> ▆▅▇▆▇▅▃▅ </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3.22 </td>
   <td style="text-align:right;"> 1.16 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> ▅▃▅▇▅▇▆▆ </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2.96 </td>
   <td style="text-align:right;"> 1.22 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> ▇▅▆▆▆▇▃▆ </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3.20 </td>
   <td style="text-align:right;"> 1.05 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> ▃▂▅▇▅▇▅▅ </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3.32 </td>
   <td style="text-align:right;"> 1.18 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> ▃▅▅▂▇▆▆▇ </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3.17 </td>
   <td style="text-align:right;"> 1.36 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:left;"> ▇▃▅▃▅▅▆▇ </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="analyse-exploratoire-graphique" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="analyse-exploratoire-graphique"><span class="header-section-number">4.3</span> Analyse exploratoire graphique</h2>
<p>Comme c’est le cas avec n’importe quelle analyse statistique, il est utile d’explorer les données graphiquement. On peut parfois réussir à visualiser les groupes d’observations, ce qui nous permettra une fois l’analyse de regroupement complétée de vérifier la qualité de cette dernière.</p>
<p>On pourrait produire un nuage de points pour chaque paire de variables mais cette idée est problématique pour deux raisons:</p>
<ol type="1">
<li>il y aura beaucoup de graphes si le nombre de variables est grand et</li>
<li>on examine seulement les relations bivariées.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pairplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-pairplot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.1: Nuage de point des paires d’observations des données <code>cluster</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Il n’est pas nécessairement évident de détecter des groupes d’observations ainsi, alors qu’on n’a déjà que six variables.</p>
<p>On peut utiliser les outils du chapitre précédent et réduire le nombre de variables en considérant plutôt les composantes principales. Dans notre exemple, on va seulement s’en servir comme outil graphique pour une analyse de regroupements en réduisant la dimension afin de permettre la visualisation des regroupements obtenus. Ces dernières pourraient aussi servir de variables pour l’analyse de regroupement: une fois les étiquettes obtenues, il suffirait de calculer les statistiques descriptives sur les variables originales.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eboulis-cluster" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-eboulis-cluster-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.2: Diagramme d’éboulis de la matrice de corrélation des données <code>cluster</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La proportion de la variance totale qui est expliquée par les deux premières composantes principales équivaut 76.7% de la variance totale originale. On ne retient que ces deux premières.</p>
<p>Même en ne connaissant pas l’appartenance des observations au regroupement, on distingue environ trois groupes. Le panneau droit du graphique <a href="#fig-04-acp">Figure&nbsp;<span>4.3</span></a> montre les deux composantes principales, mais avec l’identification des groupes obtenus suite à l’analyse de regroupement avec la méthode des <span class="math inline">\(K\)</span>-moyennes couverte plus tard.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-04-acp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-04-acp-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.3: Projection des observations sur les composantes principales avec les regroupements finaux créés à la fin du chapitre avec la méthode des <span class="math inline">\(K\)</span>-moyennes.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="choix-des-variables" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="choix-des-variables"><span class="header-section-number">4.4</span> Choix des variables</h2>
<p>Les algorithmes de segmentation utilisent une matrice de données et se base sur la distance entre observations. L’analyste est libre de choisir quelles variables seront incluses dans le modèle. Le choix des variables est important: en général on veut créer des groupes d’individus qui sont homogènes par rapport à certains aspects de leur comportement ou de leur situation. On ne doit alors inclure que les variables pertinentes à cet aspect. Inclure de nombreuses variables pour lesquelles il y a un fort similitude entre individus contribue également à diluer les différences.</p>
<p>Par exemple, si le but de l’analyse est de segmenter nos clients selon leurs habitudes de consommation (genre de boutiques fréquenté, fréquence, etc.), on n’inclura pas des variables démographiques. En fait, souvent l’analyse de regroupements servira justement à créer des groupes qui seront comparés par rapport à d’autres variables qui n’ont pas été utilisées pour créer les groupes.</p>
<p>La compréhension de la base de données est cruciale pour comprendre le comportement. Par exemple, si on essaie de faire une segmentation du comportement d’utilisateurs et utilisatrices de transports en commun à partir d’informations auxiliaires comme le temps de passage, le nombre de correspondance et la fréquence d’utilisation, il peut être utile de créer de nouvelles variables (par exemple, une variable indicatrice qui indique si la personne voyage durant les heures de traffic entre 7h30 et 9h et 16h à 18h), si elle voyage cinq jours semaines, etc. L’inclusion des ces variables auxiliaires peut augmenter la qualité de la segmentation.</p>
<p>Pour voir si certaines variables sont inutiles, il peut être utile de comparer les représentants des groupes (par exemple, le barycentre ou une observation lambda du groupe) pour voir si les moyennes ou caractéristiques diffèrent. Si ce n’est pas le cas, on pourrait envisager de recommencer la procédure en enlevant cette variable.</p>
<p>Si on a un nombre important de variables explicatives à disposition, il est parfois utile de réduire la dimension (par exemple, en effectuant une analyse en composantes principales) préalablement et à ne retenir que les premières composantes pour faciliter la tâche. Cette approche n’est pas la panacée: quelquefois, cette réduction de la dimension masque les différences entre groupe et mène à une segmentation inférieure à l’utilisation des variables originales.</p>
<p>Malheureusement, il n’est pas évident de prime abord de déterminer quelles variables inclure dans la base de données pas plus qu’il n’est facile de juger de la qualité d’une segmentation ou du nombre de regroupements à effectuer. Les choix individuels auront un impact certains sur les regroupements obtenus: on recommande d’essayer plusieurs alternatives et de vérifier graphiquement ou à l’aide de critères d’ajustement si les regroupements obtenus sont homogènes, si la distance inter-groupe est élevée et la distance intra-groupe faible (groupements compacts).</p>
<section id="standardisation" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="standardisation"><span class="header-section-number">4.4.1</span> Standardisation</h3>
<p>En général, plus une variable a une grande variance, plus elle aura de l’influence sur le calcul de la distance. Ainsi, en utilisant les variables telles quelles, nous accordons plus de poids aux variables avec de grandes variances, ce qui peut être bon ou mauvais selon la structure des groupes. Règle générale, il est préférable d’éviter qu’une variable domine dans la segmentation.</p>
<p>On peut standardiser au préalable les variables avant de faire l’analyse. Par défaut, les variables seront standardisées afin d’avoir une moyenne de zéro et une variance de un (<code>scale</code>). On peut ensuite faire les analyses comme précédemment. Si on a des valeurs aberrantes, cela peut impacter le calcul des moyennes et variances; d’autres estimateurs de localisation et d’échelles plus robustes, par exemple en soustrayant la médiane de chaque colonne et en divisant par la déviation absolue par rapport à la médiane (<code>mad</code>). Ces deux mesures pourraient être utilisées lors de la standardisation pour diminuer l’impact des valeurs aberrantes même si le coût de calcul associé est plus conséquent.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cluster, <span class="at">package =</span> <span class="st">"hecmulti"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardisation usuelle </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (soustraire moyenne, diviser par écart-type)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>cluster_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(cluster)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardisation robuste</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>cluster_std_rob <span class="ot">&lt;-</span> <span class="fu">apply</span>(cluster, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MARGIN =</span> <span class="dv">2</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                         <span class="cf">function</span>(x){</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                           (x <span class="sc">-</span> <span class="fu">median</span>(x))<span class="sc">/</span><span class="fu">mad</span>(x)})</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># apply permet d'appliquer une fonction</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># par ligne, colonne ou cellule</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># MARGIN = 2 indique colonne </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (on centre chaque colonne tour à tour)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="mesures-de-dissemblance-et-de-similarité" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="mesures-de-dissemblance-et-de-similarité"><span class="header-section-number">4.5</span> Mesures de dissemblance et de similarité</h2>
<p>Comment mesurer si deux observations appartiennent à un même regroupement et sont similaires? Idéalement, on aimerait avoir une situation comme dans la <a href="#fig-regroupements-bidons">Figure&nbsp;<span>4.4</span></a> où les regroupements sont clairement visibles. On aimerait que la similarité entre observations intra-groupe soit élevée et que la similarité entre groupe soit faible. Les regroupements devraient être éloignés les uns des autres, tandis que les observations au sein de ces regroupements devraient être proches. Dans la plupart des cas, il y aura des observations isolées qui n’appartiennent pas nécessairement logiquement à l’un ou l’autre des groupes. On appelle parfois ces observations aberrances.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-regroupements-bidons" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-regroupements-bidons-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.4: Données simulées avec deux regroupements hypothétiques.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="mesure-de-dissemblance" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="mesure-de-dissemblance"><span class="header-section-number">4.5.1</span> Mesure de dissemblance</h3>
<p>Une mesure de dissemblance sert à quantifier la distance entre deux sujets <span class="math inline">\(S_i\)</span> et <span class="math inline">\(S_j\)</span> en se basant sur les <span class="math inline">\(p\)</span> variables <span class="math inline">\(X_1, \ldots, X_p\)</span>. Plus cette mesure est petite, plus les sujets <span class="math inline">\(S_i\)</span> et <span class="math inline">\(S_j\)</span> sont similaires. Même s’il y a des exceptions, la plupart des mesures de dissemblances <span class="math inline">\(d\)</span> ont les propriétés suivantes :</p>
<ol type="1">
<li><span class="math inline">\(d(S_i, S_j) \geq 0\)</span> (positivité);</li>
<li><span class="math inline">\(d(S_i, S_i)=0\)</span>;</li>
<li><span class="math inline">\(d(S_i, S_j)=d(S_j, S_i)\)</span> (symmétrie);</li>
<li><span class="math inline">\(d(S_i, S_j)\)</span> augmente au fur et à mesure que les deux sujets deviennent plus différents.</li>
</ol>
<p>Lorsque toutes les variables sont continues, la mesure de dissemblance la plus utilisée est la distance euclidienne entre sujets, soit <span class="math display">\[\begin{align*}
d(S_i, S_j; l_2) = \sqrt{(X_{i1}-X_{j1})^2 + \cdots + (X_{ip}-X_{jp})^2}.
\end{align*}\]</span> La distance euclidienne est tout simplement la longueur du segment qui relie les deux points dans l’espace.</p>
<p>Il existe un très grand nombre d’autres mesures de dissemblance pour variables quantitatives, ordinales, nominales et binaires. Voici une brève description de certaines d’entre elles, qui sont disponibles dans <code>proc distance</code>.</p>
<p><strong>Mesures de dissemblance pour variables quantitatives:</strong></p>
<p>On peut considérer d’autres mesures de distance. Par exemple, la distance <span class="math inline">\(l_1\)</span>, ou distance de Manhattan, est la somme des valeurs absolues entre chaque composante:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <span class="math display">\[\begin{align*}
d(S_i, S_j; l_1) = |X_{i1}-X_{j1}| + \cdots + |X_{ip}-X_{jp}|
\end{align*}\]</span> Plus généralement, la distance de Minkowski ou distance <span class="math inline">\(l_q\)</span> <span class="math display">\[\begin{align*}
d(S_i, S_j; l_q) = \left\{(X_{i1}-X_{j1})^q + \cdots + (X_{ip}-X_{jp})^q\right\}^{1/q}
\end{align*}\]</span></p>
<p><strong>Mesure de dissemblance pour variables catégorielles:</strong></p>
<p>Le plus simple est d’utiliser la mesure d’appariement simple (<em>simple matching</em>). Cette mesure est simplement de la proportion des variables pour lesquelles les deux sujets ont des valeurs différentes.</p>
<p>On peut traiter les variables ordinales comme continues ou les traiter comme des variables nominales avec la mesure d’appariement simple; ce faisant, on n’utilise pas l’ordre entre les modalités.</p>
</section>
<section id="mesures-de-similarité" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="mesures-de-similarité"><span class="header-section-number">4.5.2</span> Mesures de similarité</h3>
<p>Il existe d’autres façons de définir la similarité entre observations. Par exemple, si on considère la dissemblance Euclidienne, on pourrait créer une matrice de similarité <span class="math inline">\(\mathbf{S}\)</span> <span class="math inline">\(n \times n\)</span> où les entrées indiquent si les observations sont à distance <span class="math inline">\(\varepsilon\)</span> les unes des autres (si oui, en assignant <span class="math inline">\(1\)</span> et autrement <span class="math inline">\(0\)</span>) ou encore avec <span class="math inline">\(1\)</span> pour les <span class="math inline">\(m\)</span> plus proches voisins et <span class="math inline">\(0\)</span> autrement. Cette approche sera utilisée lors de la présentation des regroupement spectraux.</p>
</section>
</section>
<section id="méthodes-de-regroupement" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="méthodes-de-regroupement"><span class="header-section-number">4.6</span> Méthodes de regroupement</h2>
<section id="k-moyennes" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="k-moyennes"><span class="header-section-number">4.6.1</span> K-moyennes</h3>
<p>L’algorithme de <span class="math inline">\(K\)</span>-moyennes est un des plus populaires pour la segmentation en raison de son faible coût de calcul et de sa simplicité.</p>
<div class="cell" data-fig.format="png" data-hash="03-regroupements_cache/html/fig-kmoy-animation_7676f26676ddbfc02b4c55f546cd1abb">
<div class="cell-output-display">
<div id="fig-kmoy-animation-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.5: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-2.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.6: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-3.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.7: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-4.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.8: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-5.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.9: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-6.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.10: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-7.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.11: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-8.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.12: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-9.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.13: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-10.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.14: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-11" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-11.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.15: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-12" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-12.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.16: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-13" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-13.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.17: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmoy-animation-14" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-kmoy-animation-14.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.18: Animation de l’algorithme des <span class="math inline">\(K\)</span>-moyennes avec <span class="math inline">\(K=3\)</span> regroupements.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="algorithm-dbscan" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="algorithm-dbscan"><span class="header-section-number">4.6.2</span> Algorithm DBSCAN</h3>
</section>
<section id="mélanges-de-modèles" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="mélanges-de-modèles"><span class="header-section-number">4.6.3</span> Mélanges de modèles</h3>
</section>
<section id="regroupements-spectraux" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="regroupements-spectraux"><span class="header-section-number">4.6.4</span> Regroupements spectraux</h3>
</section>
</section>
<section id="mesure-de-la-qualité-des-regroupements" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="mesure-de-la-qualité-des-regroupements"><span class="header-section-number">4.7</span> Mesure de la qualité des regroupements</h2>
<section id="mesures-dadéquation" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="mesures-dadéquation"><span class="header-section-number">4.7.1</span> Mesures d’adéquation</h3>
</section>
<section id="choix-des-hyperparamètres" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" class="anchored" data-anchor-id="choix-des-hyperparamètres"><span class="header-section-number">4.7.2</span> Choix des hyperparamètres</h3>
</section>
<section id="méthodes-hiérarchiques" class="level3" data-number="4.7.3">
<h3 data-number="4.7.3" class="anchored" data-anchor-id="méthodes-hiérarchiques"><span class="header-section-number">4.7.3</span> Méthodes hiérarchiques</h3>
<p>Les <strong>méthodes hiérarchiques</strong> agglomératives assignent les individus aux groupes à l’aide d’un algorithme glouton en partant du cas à <span class="math inline">\(n\)</span> groupes où chaque sujet est un groupe à part entière. La distance entre chaque paire de groupe est calculée. Les deux groupes ayant la distance la plus petite sont regroupés pour ne laisser que <span class="math inline">\(n-1\)</span> groupes. La distance entre chaque paire de groupe est à nouveau calculée (pour les groupes). Les deux groupes ayant la distance la plus petite sont regroupés pour ne former qu’un seul groupe et ainsi de suite. Le processus se continue ainsi jusqu’à ce que tous les sujets soient regroupés en un seul groupe.</p>
<p>Avec une méthode hiérarchique, on n’a pas besoin de spécifier le nombre de groupes à priori. Cependant, une fois qu’un sujet est assigné à un groupe, il ne peut le quitter pour être réassigné à un autre groupe plus tard. Ce qui différencie les différentes méthodes hiérarchiques est la manière dont est calculée la distance entre deux groupes.</p>
<p>Pour les <strong>méthodes non hiérarchiques</strong>, le nombre de groupe est spécifié au départ et un algorithme cherche, à partir d’une solution initiale, la meilleure distribution des sujets à travers ce nombre de groupe d’une manière itérative. Avec ces méthodes, l’assignation d’un sujet peut être modifiée d’une itération à l’autre. Il faut cependant spécifier le nombre de groupe et les « centres » de ces groupes au départ. La solution peut être très sensible au choix des centres initiaux.</p>
</section>
</section>
<section id="méthodes-hiérarchiques-1" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="méthodes-hiérarchiques-1"><span class="header-section-number">4.8</span> Méthodes hiérarchiques</h2>
<p>Cette méthode débute avec <span class="math inline">\(n\)</span> groupes, un par sujet, et procède en regroupant des groupes formés au préalable d’une manière hiérarchique jusqu’à ce que tous les sujets ne forment qu’un seul groupe. Le nombre de groupe retenu pourra être sélectionné à l’aide de certains critères que nous verrons plus tard.</p>
<p>À une étape donnée, il faut choisir quels groupes seront combinés. Les deux groupes dont la distance est la plus faible seront combinés. Il faut donc être en mesure de calculer la distance entre deux groupes. Nous allons décrire la méthode de Ward, qui compte parmi les plus populaires. Nous reviendrons brièvement sur d’autres méthodes plus loin.</p>
<section id="méthode-de-ward" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="méthode-de-ward"><span class="header-section-number">4.8.1</span> Méthode de Ward</h3>
<p>Cette méthode est basée sur un critère d’homogénéité global des groupes. Pour un groupe donné, cette homogénéité est mesurée par la somme des carrés des observations par rapport à la moyenne du groupe. L’homogénéité globale est alors la somme des homogénéités de tous les groupes. Plus l’homogénéité globale est petite, plus les groupes sont homogènes. À une étape donnée, les deux groupes qui causent la plus petite hausse de l’homogénéité globale (la plus petite perte d’information) sont regroupés. La méthode de Ward donne des groupes compacts d’apparence sphérique.</p>
<p>Plus précisément, supposons qu’à une étape du processus hiérarchique, nous avons <span class="math inline">\(M\)</span> groupes et que nous voulons passer à <span class="math inline">\(M-1\)</span> groupes. Pour un groupe <span class="math inline">\(K\)</span> (parmi <span class="math inline">\(1, 2, \ldots, M\)</span>), définissons la somme des carrés des distances par rapport à la moyenne du groupe, <span class="math inline">\(\mathsf{SCD}_k\)</span>. Plus <span class="math inline">\(\mathsf{SCD}_k\)</span> est petite, plus le groupe est compact et homogène.</p>
<p>On peut calculer cette distance pour tous les <span class="math inline">\(M\)</span> groupes et définir l’<strong>homogénéité globale</strong> comme la somme de l’homogénéité de tous les groupes, <span class="math display">\[\begin{align*}
\mathsf{SCD}_G = \mathsf{SCD}_1 + \cdots + \mathsf{SCD}_M.
\end{align*}\]</span> Plus l’homogénéité globale <span class="math inline">\(\mathsf{SCD}_G\)</span> est petite, mieux c’est. Pour passer de <span class="math inline">\(M\)</span> à <span class="math inline">\(M-1\)</span> groupes, la méthode de Ward va regrouper les deux groupes qui feront que <span class="math inline">\(\mathsf{SCD}_G\)</span> sera la plus petite possible.</p>
<p>On procède à une analyse simplifiée des données pour le voyage organisé avec deux variables et vingt observations afin d’être en mesure de visualiser l’algorithme de groupement.</p>
<div class="cell" data-layout-align="center">

</div>
<div class="cell" data-animation.hook="gifski" data-fig.format="png" data-hash="03-regroupements_cache/html/fig-wardAnimation_b01b22f8c63dc6826a33f6b4eec54247">
<div class="cell-output-display">
<div id="fig-wardAnimation" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-regroupements_files/figure-html/fig-wardAnimation-.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.19: Regroupements hiérarchiques sur le sous-ensemble des données, étape par étape</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La première analyse utilise la méthode de Ward. Les commandes <strong>SAS</strong> se trouvent dans <code>cluster1_simplifie.sas</code>; la présentation de la procédure et de la syntaxe est différée. L’historique de regroupement est décrit dans la sortie <strong>SAS</strong>. La première colonne donne le nombre de groupes. Au départ, les observations 16 et 19 sont regroupées, il y a maintenant 19 groupes. Ensuite, les observations 11 et 13 sont regroupées, il y a maintenant 18 groupes. Au moment de passer de 14 à 13 groupes, c’est le groupe formé à l’étape 16 qui est fusionné avec l’observation 2 et ainsi de suite. La colonne <code>Fréq</code> donne le nombre d’observations dans le groupe qui vient d’être formé.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e3.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.20: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Les quantités <code>sprsq</code> et <code>rsq</code> sont des statistiques qui peuvent servir de guide pour choisir le nombre de groupes. Le <span class="math inline">\(\mathsf{RSQ}\)</span> est une mesure similaire au <span class="math inline">\(R^2\)</span> régression linéaire qui mesure globalement à quel point les groupes sont homogènes. Elle prend une valeur entre 0 et 1 où 0 et plus le <span class="math inline">\(\mathsf{RSQ}\)</span> est élevé, meilleur le regroupement. On définit le <span class="math inline">\(\mathsf{RSQ}\)</span> comme la proportion de la variabilité expliquée par les groupes. C’est une version standardisée de la somme des homogénéités, <span class="math inline">\(\mathsf{SCD}_G\)</span>, <span class="math display">\[\begin{align*}
\mathsf{RSQ} = 1-\frac{\mathsf{SCD}_G}{\mathsf{SCD}_T},
\end{align*}\]</span> où <span class="math inline">\(\mathsf{SCD}_T\)</span> est la somme des carrés des distances par rapport à la moyenne lorsque toutes les observations sont dans un même groupe. Le graphique <a href="#fig-f4-e4">Figure&nbsp;<span>4.21</span></a> montre l’évolution du <span class="math inline">\(\mathsf{RSQ}\)</span> en fonction du nombre de groupes.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e4.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.21: Critère du R carré en fonction du nombre de groupes.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>L’idée est généralement de choisir un petit nombre de groupe avec un <span class="math inline">\(\mathsf{RSQ}\)</span> assez élevé. Ici, on voit que le <span class="math inline">\(\mathsf{RSQ}\)</span> chute brutalement en passant de trois à deux groupes (il passe de 78.2% de variabilité expliquée à 48.6%). Ainsi, choisir trois groupes semble raisonnable.</p>
<p>L’autre mesure, le <span class="math inline">\(\mathsf{SPRSQ}\)</span> ou <span class="math inline">\(R\)</span> carré semi-partiel, mesure la perte d’homogénéité résultant du fait que l’on vient de former un nouveau groupe. Comme on veut des groupes homogènes, on veut qu’elle soit petite. Plus précisément, supposons que les groupes <span class="math inline">\(k_1\)</span> et <span class="math inline">\(k_2\)</span> viennent d’être regroupés à une étape donnée. Soient <span class="math inline">\(\mathsf{SCD}_{k_1}\)</span> et <span class="math inline">\(\mathsf{SCD}_{k_2}\)</span> les homogénéités de ces deux groupes et <span class="math inline">\(\mathsf{SCD}_{k}\)</span> l’homogénéité du nouveau groupe formé en fusionnant les deux. On définit la perte d’homogénéité (relative) en combinant ces deux groupes <span class="math display">\[\begin{align*}
\mathsf{SPRSQ} = \frac{\mathsf{SCD}_k - \mathsf{SCD}_{k_1} - \mathsf{SCD}_{k_2}}{\mathsf{SCD}_T}
\end{align*}\]</span> On peut ainsi tracer une courbe pour le <span class="math inline">\(\mathsf{SPRSQ}\)</span> en fonction du nombre de groupes, comme dans le graphique <a href="#fig-f4-e5">Figure&nbsp;<span>4.22</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e5.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.22: Courbe du <span class="math inline">\(R^2\)</span> semi-partiel en fonction du nombre de regroupements hiérarchiques.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La procédure <strong>SAS</strong> qui permet d’effectuer une analyse de regroupements hiérarchique est <code>cluster</code>. Le fichier <code>cluster2_complet.sas</code> explique les différentes options disponibles.</p>
<div class="cell">
<details>
<summary>Code</summary>
<pre class="sas cell-code"><code>proc cluster data=temp method=ward outtree=temp1 nonorm rsquare;
var x1-x6;
copy id cluster_vrai x1-x6;
ods output stat.cluster.ClusterHistory=criteres;
run;</code></pre>
</details>
</div>
<p>On peut représenter graphique le R carré (Figure <a href="#fig-f4-e7">Figure&nbsp;<span>4.23</span></a>), le R carré semi partiel (Figure <a href="#fig-f4-e8">Figure&nbsp;<span>4.24</span></a>) en fonction du nombre de groupes.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e8.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.23: R carré en fonction des regroupements hiérarchiques</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e9.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.24: R carré semi-partiel en fonction des regroupements hiérarchiques</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Parfois, l’information est présentée sous forme de dendogramme, qui trace l’arbre et la fusion des groupes. On peut ainsi retracer l’historique de la procédure hiérarchique. Celui produit par <strong>SAS</strong> donne, à un facteur multiplicatif près, le <span class="math inline">\(\mathsf{SPRSQ}\)</span>. Il n’y a donc pas de nouvelles informations ici. On voit que c’est lorsqu’on passe de trois à deux groupes, qu’il y a une bonne perte d’homogénéité.</p>
<p>En pratique, on ne peut jamais savoir si on a bel et bien regroupé ensemble les bons sujets. Mais ici, comme il s’agit de données artificielles qui ont été générées, nous connaissons la composition des vrais groupes. Il s’avère qu’il y en a effectivement trois. De plus, la solution à trois groupes obtenue avec la méthode de Ward a bien réussi à retrouver les groupes. Ceci est un exemple facile où les observations sont bien séparées: ce ne sera pas toujours aussi simple en pratique.</p>
<p><strong>Interprétation des groupes</strong>: la méthode la plus simple consiste à inspecter les moyennes des variables de chaque groupe et de voir s’il en découle une interprétation raisonnable. La procédure <code>tree</code> permet d’extraire la solution avec un nombre spécifié de groupes et il est ensuite facile (avec la procédure <code>means</code>) d’obtenir ces moyennes (voir le fichier <code>cluster2_complet.sas</code>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e11" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e11.png" class="img-fluid figure-img" style="width:55.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.25: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e12" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e12.png" class="img-fluid figure-img" style="width:55.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.26: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e13" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e13.png" class="img-fluid figure-img" style="width:55.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.27: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Le groupe 1 est le groupe où les sujets ont les valeurs, en moyenne, les plus faibles pour les six variables. Le groupe 2 est celui où les sujets ont les valeurs, en moyenne, les plus élevées pour les 6 variables sauf pour la variable <span class="math inline">\(X_1\)</span> (activité sociale). Le groupe 3 est celui où les sujets ont, en moyenne, la valeur la plus élevée de la variable <span class="math inline">\(X_1\)</span> et des valeurs moyennes inférieures au groupe 3 mais supérieures au groupe 2 pour les cinq autres variables.</p>
<p>Dans l’article, les auteurs ont baptisé les sujets du groupe 1, les « indépendants », ceux du groupe 2, les « dépendants » et ceux du groupe 3, les « sociables ». Notez qu’on <strong>ne peut pas</strong> tester l’égalité des moyennes des variables pour les différents groupes avec une ANOVA; la sélection des groupes est faite à l’aide d’un algorithme glouton pour maximiser la distance entre les groupes, aussi cela invalide l’inférence. On peut aussi explorer les groupes en modélisant les effets des variables en ce qui a trait à l’appartenance aux groupes. Traditionnellement, l’analyse discriminante est utilisée à cette fin. Il est aussi possible d’utiliser un arbre de classification ou une autre méthode prévisionnelle, telle la régression multinomiale logistique. La variable identifiant le groupe d’appartenance obtenu avec l’analyse de regroupement sert alors de variable dépendante <span class="math inline">\(Y\)</span>. Ce type d’analyse permet de creuser un peu plus pour essayer de comprendre la structure des groupes formés.</p>
</section>
</section>
<section id="calcul-alternatif-des-distances-pour-le-regroupement-hiérarchique" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="calcul-alternatif-des-distances-pour-le-regroupement-hiérarchique"><span class="header-section-number">4.9</span> Calcul alternatif des distances pour le regroupement hiérarchique</h2>
<p>Nous avons utilisé la méthode de Ward afin de calculer la distance entre les groupes et procéder au passage de <span class="math inline">\(n\)</span> groupes à un groupe, avec l’approche hiérarchique. Supposons que nous avons choisi une mesure de dissemblance <span class="math inline">\(d(S_i, S_j)\)</span> quelconque (distance euclidienne par exemple) pour mesurer la distance entre deux sujets. Voici comment sont choisis les regroupements avec ces méthodes.</p>
<ul>
<li>Méthode du plus proche voisin ou méthode de liaison simple (<em>nearest neighbor</em>, <em>single linkage</em>): utilise la distance minimale entre chaque paire de sujets (un pour chaque groupe) provenant des deux groupes. Cette méthode fonctionne bien si l’écart entre deux regroupements est suffisamment grand. À l’inverse, s’il y a des observations bruitées entre deux regroupements, la qualité des regroupements en sera affectée.</li>
<li>Méthode du voisin le plus éloigné ou méthode de liaison complète (<em>complete linkage</em>): utilise la distance maximale entre toutes les paires de sujets (un pour chaque groupe) provenant des deux groupes. Cette méthode est moins sensible au bruit et aux faibles écarts entre regroupements, mais a tendance à casser les regroupements globulaires.</li>
<li>Méthode de liaison moyenne (<em>average linkage</em>): utilise la moyenne des distances entre toutes les paires de sujets (un pour chaque groupe) provenant des deux groupes.</li>
<li>Méthode du barycentre (<em>centroid</em>): utilise la distance entre les représentants moyens de chaque groupe où le représentant moyen d’un groupe est le barycentre, soit la moyenne variable par variable, des sujets formant le groupe.</li>
</ul>
<p>Le fichier <code>cluster3_voisin_eloigne.sas</code> contient les commandes pour utiliser la méthode du voisin le plus éloigné (avec l’option <code>method=complete</code>). Le graphe plus bas donne cette distance pour les deux groupes qui viennent d’être fusionnés. Il s’agit donc du maximum des distances entre chaque paire de sujets (un pour chaque groupe) provenant des deux groupes fusionnés.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e21" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e21.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.28: Distance maximale entre groupes en fonction des regroupements hiérarchiques pour la méthode du voisin le plus éloigné.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Comme on veut que cette distance soit petite pour les groupes fusionnés, on pourrait être tenté d’arrêter à trois groupes ici sur la base de la Figure <a href="#fig-f4-e20">Figure&nbsp;<span>4.29</span></a>. L’interprétation des groupes ne change pas comparativement aux analyses précédentes. La taille des groupes, (44, 71, 35), change un peu par rapport à la solution avec la méthode de Ward qui donnait des tailles de (43, 75, 32).</p>
<p>On peut comparer les performances des regroupements hiérarchiques selon la méthode de groupement. La <a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_linkage_comparison.html">page web de scikit-learn developers</a> montre la performance sur des exemples jouets, qui montre que selon les hypothèses et la structure, aucune ne performe mieux que les autres dans tous les exemples.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e20" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e20.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.29: Comparaison des méthodes de groupement sur des données test</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dbscan)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Trois plus proches voisins</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">quantile</span>(dbscan<span class="sc">::</span><span class="fu">kNNdist</span>(cluster, <span class="at">k =</span> <span class="dv">3</span>), </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">probs =</span> <span class="fl">0.9</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>regroup_dbscan <span class="ot">&lt;-</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  dbscan<span class="sc">::</span><span class="fu">dbscan</span>(<span class="at">x =</span> cluster, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">eps =</span> eps, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">minPts =</span> <span class="dv">3</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(cluster, <span class="at">col =</span> regroup_dbscan<span class="sc">$</span>cluster <span class="sc">+</span> 1L)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="03-regroupements_files/figure-html/dbscan-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regroupements spectraux</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> FCPS<span class="sc">::</span><span class="fu">SpectralClustering</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Data =</span> cluster,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ClusterNo =</span> <span class="dv">3</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): ClusterRename:
DataOrDistances number of rows does not equal length of Cls. Nothing is done</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(cluster, <span class="at">col =</span> clust<span class="sc">$</span>Cls <span class="sc">+</span> <span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="03-regroupements_files/figure-html/dbscan-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Encore une fois, l’interprétation des groupes ne change pas comparativement aux analyses précédentes. La taille des groupes, (45, 75, 30) change un peu par rapport à la solution avec la méthode de Ward qui donnait des tailles de (43, 75, 32).</p>
<p>Règle générale, les différentes étapes des méthodes agglomératives hiérarchiques nécessitent <span class="math inline">\(\mathrm{O}(n^3)\)</span> opérations, bien qu’une version plus parsimonieuse existe avec complexité <span class="math inline">\(\mathrm{O}(n^2\ln n)\)</span> ou <span class="math inline">\(\mathrm{O}(n^2)\)</span> pour les méthodes de liaison simple et complexe. La formule de Lance–Williams permet de mettre à jour récursivement les distances entre regroupements pour la plupart des méthodes considérées. Le coût élevé de la méthode de regroupement hiérarchique, qui dépend de la taille de l’échantillon, devient prohibitif avec des mégadonnées. Il nécessite aussi le calcul d’une mesure de dissemblance et l’évaluation de la qualité de l’agglomération, autre que graphique, n’est pas évidente. Ces méthodes sont largement discontinuées de nos jours par des alternatives modernes (regroupement spectraux, mélanges de modèles, <span class="math inline">\(K\)</span>-médoïdes par itérations de Voronoï).</p>
</section>
<section id="méthodes-non-hiérarchiques" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="méthodes-non-hiérarchiques"><span class="header-section-number">4.10</span> Méthodes non hiérarchiques</h2>
<p>Contrairement aux méthodes hiérarchiques, il faut spécifier le nombre de groupe désiré dès le départ pour les méthodes non hiérarchiques.</p>
<p>Nous allons utiliser cette procédure pour raffiner la solution obtenue précédemment avec la méthode de Ward en utilisant les moyennes des groupes comme centres préliminaires. Le fichier <code>cluster5_non-hierarchique.sas</code> explique les différentes options. La syntaxe de la procédure <strong>SAS</strong> <code>fastclus</code> est la suivante:</p>
<div class="cell">
<details>
<summary>Code</summary>
<pre class="sas cell-code"><code>proc fastclus data=temp seed=initial distance maxclusters=3 out=temp3 maxiter=30;
var x1 x2 x3 x4 x5 x6;
run;</code></pre>
</details>
</div>
<p>Voici une partie de la sortie <strong>SAS</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e14" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e14.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.30: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e15" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e15.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.31: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e16" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e16.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.32: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Évidemment, comme la solution obtenue avec la méthode de Ward est déjà excellente, on ne pourra pas avoir une amélioration notable. Il y a peu de changements par rapport à la solution de la méthode de Ward. Les tailles des groupes étaient de (43, 75, 32) avant. Elles sont maintenant (45, 77, 28). Le <span class="math inline">\(R^2\)</span> passe de 65,7% (avec Ward) à 66.2%.</p>
<p>L’interprétation des groupes est la même que précédemment.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f4-e17" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-clustering-e17.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.33: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Le champ des applications des <span class="math inline">\(K\)</span>-moyennes est parfois surprenant. Par exemple, <a href="https://fivethirtyeight.com/features/the-5-political-boroughs-of-new-york-city/">cet article de FiveThirtyEight propose une segmentation des électeurs démocrates new-yorkais</a>. Un autre exemple incongru est la compression d’images: la Figure <a href="#fig-decelles">Figure&nbsp;<span>4.34</span></a> montre une image du bâtiment Decelles (coin supérieur gauche) et la reconstruction avec trois, quatre et 10 couleurs obtenues en appliquant l’algorithme des <span class="math inline">\(K\)</span>-moyennes sur la matrice formée par les valeurs des canaux (rouge, vert, bleu) de l’image.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-decelles" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/kmoyennes_decelles.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.34: Compression d’image avec l’algorithme des <span class="math inline">\(K\)</span>-moyennes: image originale (en haut à gauche), compression avec trois (en haut à droite), quatre (en bas à gauche) et 10 (en bas à droite) couleurs.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="considérations-pratiques" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="considérations-pratiques"><span class="header-section-number">4.11</span> Considérations pratiques</h2>
<p>Il peut être intéressant de comparer les résultats provenant d’une même méthode avec des nombres différents de groupes et aussi comparer ceux provenant de plusieurs méthodes (voir plus loin pour la description de certaines autres méthodes). Le choix de la méthode et du nombre de groupe n’est pas facile et devrait être basé sur des considérations pratiques et d’interprétation (comme en analyse factorielle). Il n’est pas rare qu’on obtienne des résultats très différents d’une méthode à l’autre pour un même ensemble de données.</p>
<p>Avec une méthode non hiérarchique, il est préférable de fournir des germes de départ « raisonnablement bon » (provenant d’une méthode hiérarchique par exemple) plutôt que de laisser l’algorithme les choisir au hasard.</p>
<p>Dans notre exemple sur les voyages organisés, on a segmenté les voyageurs en trois groupes (indépendants, dépendants et sociables). Les auteurs de l’article (voir page 369 de l’article) ont comparé les trois groupes selon l’expérience de voyage, la taille de la communauté où ils habitent (avec des ANOVA), selon leur âge, leur revenu et leur éducation (avec des tests d’indépendance du khi-deux). Notez que ces tests sont réalisés sur des variables qui ne sont pas utilisées lors de la segmentation: ils sont invalides si les données sont corrélées avec celle utilisées pour la segmentation. La logique est qu’on choisit les groupes pour maximiser les distances inter-groupes, donc forcément les tests d’hypothèse auront tendance à trouver des différences de moyenne quand ces différences sont trompeuses.</p>
<p>Le problème majeur avec l’analyse de regroupements est qu’il n’y a pas de façon claire de quantifier la performance de notre analyse. Lorsqu’on développe un modèle de prédiction (régression linéaire ou logistique par exemple), on peut estimer la performance de notre modèle d’une manière objective à l’aide de l’erreur quadratique de généralisation (régression linéaire) ou du taux de bonne classification (régression logistique). Ces quantités peuvent être estimées d’une manière objective en utilisant une méthode telle la validation croisée ou la division de l’échantillon. On ne peut faire de même avec l’analyse de regroupements car on n’a pas de variable réponse à prédire. Tout comme pour l’analyse factorielle, les connaissances à priori, le jugement, et les considérations pratiques font partie d’une analyse de regroupements.</p>


</section>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1" role="doc-endnote"><p>En deux dimensions, si on considère une ville comme New York dont les rues sont quadrillées, cela revient à marcher le long des rues alors que la distance Euclidienne traverse les édifices.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-analysefactorielle.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Réduction de la dimension</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-selectionmodeles.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sélection de variables et de modèles</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>