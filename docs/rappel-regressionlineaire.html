<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="MATH 60602 - Analyse multidimensionnelle appliquée, HEC Montréal.">

<title>MATH 60602 - Analyse multidimensionnelle appliquée - 9&nbsp; Régression linéaire</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rappel-regressionlineaire.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régression linéaire</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MATH 60602 - Analyse multidimensionnelle appliquée</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/lbelzile/math60602/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./MATH60602.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyseexploratoire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analyse exploratoire</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./selectionmodeles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sélection de variables et de modèles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reglogistique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Régression logistique</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analyse de survie</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysefactorielle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Réduction de la dimension</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regroupements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Analyse de regroupements</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./donneesmanquantes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Données manquantes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rappel-regressionlineaire.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régression linéaire</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#exemple-et-motivation" id="toc-exemple-et-motivation" class="nav-link active" data-scroll-target="#exemple-et-motivation"><span class="header-section-number">9.1</span> Exemple et motivation</a></li>
  <li><a href="#interprétation-des-paramètres-du-modèles" id="toc-interprétation-des-paramètres-du-modèles" class="nav-link" data-scroll-target="#interprétation-des-paramètres-du-modèles"><span class="header-section-number">9.2</span> Interprétation des paramètres du modèles</a>
  <ul class="collapse">
  <li><a href="#polynômes" id="toc-polynômes" class="nav-link" data-scroll-target="#polynômes"><span class="header-section-number">9.2.1</span> Polynômes</a></li>
  </ul></li>
  <li><a href="#budget-pour-lestimation" id="toc-budget-pour-lestimation" class="nav-link" data-scroll-target="#budget-pour-lestimation"><span class="header-section-number">9.3</span> Budget pour l’estimation</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/lbelzile/math60602/edit/master/rappel-regressionlineaire.qmd" class="toc-action">Éditer cette page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="regression-lineaire" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régression linéaire</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Les modèles de régression servent à modéliser la moyenne<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> d’une variable réponse <span class="math inline">\(Y\)</span> en fonction de <span class="math inline">\(p\)</span> variables explicatives (appelées parfois régresseurs ou covariables) à l’aide d’une équation de la forme <span class="math display">\[\begin{align*}
\underbrace{\mathsf{E}(Y_i \mid \mathbf{X}_i)}_{\text{moyenne de la $i$e réponse}}=\underbrace{\beta_0 + \beta_1\mathrm{X}_{i1} + \cdots + \beta_p \mathrm{X}_{ip}}_{\text{combinaison linéaire de variables explicatives}}.
\end{align*}\]</span> où <span class="math inline">\(\mathrm{X}_{ij}\)</span> est la <span class="math inline">\(i\)</span>e ligne, <span class="math inline">\(j\)</span>e colonne du tableau contenant variables explicatives (chaque colonne correspond à une variable).</p>
<p>Dans le modèle de régression ordinaire, toutes les observations qui ont les mêmes charactéristiques (c’est-à-dire, les mêmes valeurs des variables explicatives) ont la même moyenne, même si les observations ne sont pas identiques.</p>
<p>On peut ajouter un terme d’erreur qui sert à tenir compte du fait qu’aucune relation linéaire exacte ne lie <span class="math inline">\(\mathbf{X}\)</span> et <span class="math inline">\(Y\)</span>, ou que les mesures de <span class="math inline">\(Y\)</span> contiennent des erreurs. Ce terme d’erreur aléatoire <span class="math inline">\(\varepsilon\)</span>, souvent supposé tiré d’une loi normale, servira de base à l’inférence car il permettra de quantifier l’adéquation entre notre modèle et les données.</p>
<p>On peut réécrire le modèle linéaire en terme de l’erreur pour un échantillon aléatoire de taille <span class="math inline">\(n\)</span>: dénotons par <span class="math inline">\(Y_i\)</span> la valeur de <span class="math inline">\(Y\)</span> pour le sujet <span class="math inline">\(i\)</span>, et <span class="math inline">\(\mathrm{X}_{ij}\)</span> la valeur de la <span class="math inline">\(j\)</span>e variable explicative du sujet <span class="math inline">\(i\)</span>. Le modèle de régression linéaire est <span id="eq-olsmean"><span class="math display">\[
\underbrace{Y_i}_{\text{réponse}} = \underbrace{\beta_0 + \beta_1 \mathrm{X}_{i1} + \ldots + \beta_p \mathrm{X}_{ip}}_{\text{moyenne}} + \underbrace{\varepsilon_{i}}_{\text{erreur}}
\tag{9.1}\]</span></span> où <span class="math inline">\(\varepsilon_i\)</span> est le terme d’erreur <span class="math inline">\((i=1, \ldots, n\)</span>). Si aucune hypothèse sur la loi aléatoire de l’erreur n’est spécifiée, on fixe a minima la moyenne théorique du terme d’erreur à zéro car on postule qu’il n’y a pas d’erreur systématique.</p>
<p>Le postulat de normalité sert à exprimer ce fait et à caractériser les déviations possibles: on suppose que la probabilité d’observer une valeur supérieure ou inférieure est la même, mais que les déviations importantes par rapport à la moyenne sont moins plausibles. Ce postulat de normalité en est un de convenance: on pénalise les déviations par rapport à <span class="math inline">\(\mu\)</span> et l’écart-type commun à toutes les observations, <span class="math inline">\(\sigma\)</span>, mesure cette écart. S’il y a peu de bruit et que la relation linéaire entre les variables explicatives et la réponse est très forte (capturée par la corrélation entre variables), le modèle reflètera adéquatement les données et l’écart-type estimé sera faible.</p>
<p>La flexibilité du modèle linéaire vient de sa formulation: on spécifie la moyenne de la réponse <span class="math inline">\(Y\)</span> comme <strong>combinaison linéaire de variables explicatives</strong>, dont le choix est arbitraire. Il est important de remarquer que ce modèle est linéaire dans les coefficients <span class="math inline">\(\boldsymbol{\beta}\in \mathbb{R}_{p+1}\)</span>, pas dans les variables explicatives. Ces dernières sont quelconques et peuvent être des fonctions (non)-linéaires d’autres variables explicatives, par exemple <span class="math inline">\(\mathrm{X}=\log(\texttt{annees})\)</span>, <span class="math inline">\(\mathrm{X}=\texttt{puissance}^2\)</span> ou <span class="math inline">\(\mathrm{X}= \mathsf{I}_{\texttt{homme}}\cdot\mathsf{I}_{\texttt{titulaire}}\)</span>. C’est ce qui fait la flexibilité du modèle linéaire: ce dernier est principalement employé aux fins suivantes:</p>
<ol type="1">
<li>Comprendre comment et dans quelle mesure les variables explicatives <span class="math inline">\(\mathbf{X}\)</span> influencent la moyenne de la réponse <span class="math inline">\(Y\)</span> (description).</li>
<li>Quantifier l’influence des variables explicatives <span class="math inline">\(\mathbf{X}\)</span> sur la régressande <span class="math inline">\(Y\)</span> et tester leur significativité.</li>
<li>Prédire les valeurs de <span class="math inline">\(Y\)</span> pour de nouveaux ensembles de covariables <span class="math inline">\(\mathbf{X}\)</span>.</li>
</ol>
<section id="exemple-et-motivation" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="exemple-et-motivation"><span class="header-section-number">9.1</span> Exemple et motivation</h2>
<p>Le modèle linéaire est sans conteste le modèle statistique le plus couramment employé. Une grande panoplie de tests statistiques (tests-<em>t</em>, analyse de variance) sont des cas particuliers de régression linéaire.</p>
<p>Afin de rendre plus tangible le concept et les notions qui touchent aux modèles linéaires, on présentera ces notions dans le cadre d’un exemple. On s’intéresse à la discrimination salariale dans un collège américain, au sein duquel une étude a été réalisée pour investiguer s’il existait des inégalités salariales entre hommes et femmes. Le jeu de données <code>salaireprof</code> contient les variables suivantes</p>
<ul>
<li><code>salaire</code>: salaire de professeurs pendant l’année académique 2008–2009 (en milliers de dollars USD).</li>
<li><code>echelon</code>: échelon académique, soit adjoint (<code>adjoint</code>), aggrégé (<code>aggrege</code>) ou titulaire (<code>titulaire</code>).</li>
<li><code>domaine</code>: variable catégorielle indiquant le champ d’expertise du professeur, soit appliqué (<code>applique</code>) ou théorique (<code>theorique</code>).</li>
<li><code>sexe</code>: indicateur binaire pour le sexe, <code>homme</code> ou <code>femme</code>.</li>
<li><code>service</code>: nombre d’années de service.</li>
<li><code>annees</code>: nombre d’années depuis l’obtention du doctorat.</li>
</ul>
<p>Une analyse exploratoire des données est de mise avant d’ébaucher un modèle. Si le salaire augmente au fil des ans, on voit que l’hétérogénéité change en fonction de l’échelon et qu’il y a une relation claire entre ce dernier et le nombre d’années de service (les professeurs n’étant éligibles à des promotions qu’après un certain nombre d’années). Les professeurs adjoints qui ne sont pas promus sont généralement mis à la porte, aussi il y a moins d’occasions pour que les salaires varient sur cette échelle.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/fig-edacollege_f01e5f01aa92d0ff3c273d375bfb248c">
<div class="cell-output-display">
<div id="fig-edacollege" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rappel-regressionlineaire_files/figure-html/fig-edacollege-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.1: Analyse exploratoire des données <span class="math inline">\(\texttt{salaireprof}\)</span>: répartition des salaires en fonction de l’échelon et du nombre d’années de service</figcaption>
</figure>
</div>
</div>
</div>
<p>Ainsi, le salaire augmente avec les années, mais la variabilité croît également. Il y a peu de femmes dans l’échantillon: moins d’information signifie moins de puissance pour détecter de petites différences de salaire. Si on fait un tableau de contingence de l’échelon et du sexe, on peut calculer la proportion relative homme/femme dans chaque échelon: 16% des profs adjoints, 16% pour les aggrégés, mais seulement 7% des titulaires alors que ces derniers sont mieux payés en moyenne.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/tbl-tableaucontingence_c40e1431bf1a3621e8cef8685f326f85">
<div class="cell-output-display">
<div id="tbl-tableaucontingence" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;9.1: Tableau de contingence donnant le nombre de professeurs du collège par sexe et par échelon académique.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">adjoint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">aggrege</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">titulaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">femme</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">homme</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">248</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Le modèle linéaire simple n’inclut qu’une variable explicative et consiste en une droite d’équation <span class="math inline">\(y=\beta_0 + \beta_1 \mathrm{X}\)</span> qui passe à travers un nuage de points. La <a href="#fig-droitenuage">Figure&nbsp;<span>9.2</span></a> montre la droite de régression dans le nuage de points formé par les couples <span class="math inline">\(\{\mathrm{X}_i, y_i\}\)</span>, où <span class="math inline">\(y_i\)</span> est le <code>salaire</code> et <span class="math inline">\(\mathrm{X}\)</span> est <code>service</code>.</p>
<p><strong>Programmation</strong>: Pour ajuster un modèle linéaire avec <strong>R</strong>, on utilise la fonction <code>lm</code>. Le premier argument est une formule, sous la forme <code>y ~ x</code> où <code>y</code> est la variable réponse et <code>x</code> la variable explicative. La fonction utilisera (si disponible) les variables disponibles dans la base de données spécifiée via l’argument <code>data</code>. Ici, notre variable réponse est le <code>salaire</code> et nous tentons d’expliquer ce dernier en fonction du nombre d’années de service, ici représenté par la variable continue <code>service</code>.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/unnamed-chunk-5_a43736d78991b719ece0a3ff0998c625">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(salaireprof, <span class="at">package =</span> <span class="st">"hecmulti"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>modlin1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(salaire <span class="sc">~</span> service, <span class="at">data =</span> salaireprof)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modlin1)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = salaire ~ service, data = salaireprof)

Residuals:
    Min      1Q  Median      3Q     Max 
-81.933 -20.511  -3.776  16.417 101.947 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  99.9747     2.4166   41.37  &lt; 2e-16 ***
service       0.7796     0.1104    7.06 7.53e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 28.58 on 395 degrees of freedom
Multiple R-squared:  0.1121,    Adjusted R-squared:  0.1098 
F-statistic: 49.85 on 1 and 395 DF,  p-value: 7.529e-12</code></pre>
</div>
</div>
<p>Une fois le modèle estimé, on peut extraire les coefficients avec la méthode <code>coef</code>, ici via <code>coef(modlin1)</code>, ou imprimer un tableau résumé avec <code>summary</code>. Ce dernier contient quatre colonnes qui donnent</p>
<ul>
<li>les estimations des paramètres de la moyenne <span class="math inline">\(\widehat{\beta}\)</span></li>
<li>les erreur-types des estimations <span class="math inline">\(\mathsf{se}(\widehat{\beta})\)</span> (qui représente leur incertitude)</li>
<li>la statistique <span class="math inline">\(t\)</span> obtenue en comparant la valeur de <span class="math inline">\(\widehat{\beta}\)</span> à la valeur sous l’hypothèse nulle <span class="math inline">\(\beta=0\)</span>, standardisée par l’erreur-type, <span class="math inline">\(t=\widehat{\beta}/\mathsf{se}(\widehat{\beta})\)</span>.</li>
<li>la valeur-<span class="math inline">\(p\)</span> pour le test <span class="math inline">\(\beta_i=0\)</span>.</li>
</ul>
<p>Notez qu’on ignore systématiquement les valeurs-<span class="math inline">\(p\)</span> pour la première ligne qui correspond à l’ordonnée à l’origine <code>(Intercept)</code>.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/fig-droitenuage_27db9cb43af3a3bb905b169ea734d9d7">
<div class="cell-output-display">
<div id="fig-droitenuage" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rappel-regressionlineaire_files/figure-html/fig-droitenuage-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;9.2: Régression linéaire simple pour le salaire en fonction des années de service; la droite satisfait le critère des moindres carrés.</figcaption>
</figure>
</div>
</div>
</div>
<p>Une infinité de droites pourraient passer dans le nuage de points; il faut donc choisir la meilleure droite (selon un critère donné). Le critère des moindres carrés, qui consiste à minimiser la somme du carré des erreurs (soit la somme de la distance verticale entre la droite et les observations) permet d’obtenir des estimations des paramètres. La solution du problème d’optimisation est explicite et facilement calculée par n’importe lequel logiciel.</p>
<p>Les estimateurs des moindres carrés ordinaires <span class="math inline">\(\widehat{\boldsymbol{\beta}}=(\widehat{\beta}_0, \ldots, \widehat{\beta}_p)\)</span> sont les paramètres qui minimisent simultanément la distance euclidienne entre les observations <span class="math inline">\(y_i\)</span> et les <strong>valeurs ajustées</strong> <span class="math display">\[\begin{align*}
\widehat{y}_i &amp;= \widehat{\beta}_0 + \widehat{\beta}_1 \mathrm{X}_{i1} + \cdots + \widehat{\beta}_p \mathrm{X}_{ip}, \qquad i =1, \ldots, n.
\end{align*}\]</span> En d’autres mots, les estimateurs des moindres carrés sont la solution du problème <span class="math display">\[\begin{align*}
\widehat{\boldsymbol{\beta}} &amp;=\min_{\boldsymbol{\beta} \in \mathbb{R}^{p+1}}\sum_{i=1}^n (y_i-\widehat{y}_i)^2
\end{align*}\]</span></p>
<p>Que représente les moindres carrés en deux dimensions? L’estimateur est celui qui minimise la somme du carré des résidus ordinaires. Le <span class="math inline">\(i\)</span>e <strong>résidu ordinaire</strong> <span class="math inline">\(e_i = y_i -\widehat{y}_i\)</span>, obtenu via <code>resid()</code>, est la distance <em>verticale</em> entre un point <span class="math inline">\(y_i\)</span> et la valeur ajustée <span class="math inline">\(\widehat{y}_i\)</span>, soit les traits bleus de la <a href="#fig-distancevert">Figure&nbsp;<span>9.3</span></a>. C’est cette distance au carré qu’on veut minimiser.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/fig-distancevert_7fb67ea0bbd91481ea89911d8f6cf187">
<div class="cell-output-display">
<div id="fig-distancevert" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rappel-regressionlineaire_files/figure-html/fig-distancevert-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;9.3: Illustration des résidus ordinaires ajoutés à la droite de régression.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="interprétation-des-paramètres-du-modèles" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="interprétation-des-paramètres-du-modèles"><span class="header-section-number">9.2</span> Interprétation des paramètres du modèles</h2>
<p>Que représentent les paramètres <span class="math inline">\(\boldsymbol{\beta}\)</span> du modèle linéaire? Dans le cas simple présenté dans la <a href="#fig-droitenuage">Figure&nbsp;<span>9.2</span></a> où l’équation de la droite est de la forme <span class="math inline">\(\widehat{Y} = \widehat{\beta}_0 + \widehat{\beta}_1\mathrm{X}_1\)</span>, <span class="math inline">\(\beta_0\)</span> est l’ordonnée à l’origine (la valeur moyenne de <span class="math inline">\(Y\)</span> quand <span class="math inline">\(\mathrm{X}_1=0\)</span>) et <span class="math inline">\(\beta_1\)</span> est la pente, soit l’augmentation moyenne de <span class="math inline">\(Y\)</span> quand <span class="math inline">\(\mathrm{X}_1\)</span> augmente d’une unité.</p>
<p>Dans certains cas, l’interprétation de l’ordonnée à l’origine n’est pas valide car c’est un <strong>non-sens</strong>: la valeur <span class="math inline">\(\mathrm{X}_1=0\)</span> n’est pas plausible (par exemple, si <span class="math inline">\(\mathrm{X}_1\)</span> est la taille d’un humain). De même, il peut arriver qu’il n’y ait pas d’observations dans le voisinage de <span class="math inline">\(\mathrm{X}_1=0\)</span>, même si cette valeur est plausible; on parle alors d’extrapolation.</p>
<p>Il est d’usage d’inclure une colonne de uns pour capturer l’ordonnée à l’origine <span class="math inline">\(\beta_0\)</span>: cette dernière est incluse par défaut et permet de s’assurer que les résidus ordinaires <span class="math inline">\(e_i = Y_i - \widehat{\mu}_i\)</span> ont moyenne nulle, comme le sous-tend notre spécification pour l’erreur. Elle joue donc un rôle particulier. Le modèle de base, le plus simple qui soit, reviendrait à n’inclure que le terme <span class="math inline">\(\beta_0\)</span> et on obtiendrait alors comme estimation la moyenne de toutes les observations, avec l’estimé <span class="math inline">\(\widehat{\beta}_0 = \overline{y}\)</span>. On peut vérifier que la moyenne des erreurs est bien zéro.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/unnamed-chunk-8_2bc0f96b5b0bcf8abbc10114807e24cd">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si on inclut une ordonnée à l'origine, la moyenne des erreurs est nulle</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">resid</span>(modlin1))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.351804e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de base avec uniquement l'ordonnée à l'origine</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># beta0 estimée comme moyenne</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(salaire <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> salaireprof))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   113.7065 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(salaireprof<span class="sc">$</span>salaire)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 113.7065</code></pre>
</div>
</div>
<p>Dans notre exemple, l’équation de la droite ajustée de la <a href="#fig-droitenuage">Figure&nbsp;<span>9.2</span></a> est <span class="math display">\[
\widehat{\texttt{salaire}} = 99.9746529 + 0.7795691\texttt{service}.
\]</span></p>
<p>Ainsi, le salaire moyen d’un nouveau professeur serait 99975 dollars, tandis que l’augmentation moyenne annuelle du salaire est 780 dollars.</p>
<p>Si la variable réponse <span class="math inline">\(Y\)</span> doit être <em>continue</em>, il n’y a aucune restriction pour les variables explicatives. On peut aussi considérer des variables explicatives binaires, qui sont encodées numériquement à l’aide de 0/1. Par exemple, si on s’intéresse au sexe des professeurs de l’étude, <span class="math display">\[
\texttt{sexe} = \begin{cases} 0 , &amp; \text{pour les hommes},\\
1, &amp; \text{pour les femmes.}
\end{cases}
\]</span> L’équation du modèle linéaire simple qui n’inclut que cette variable catégorielle à deux niveaux, <span class="math inline">\(\texttt{sexe}\)</span>, s’écrit <span class="math inline">\(\texttt{salaire} = \beta_0 + \beta_1 \texttt{sexe} + \varepsilon\)</span>. Posons <span class="math inline">\(\mu_0\)</span> le salaire moyen des femmes et <span class="math inline">\(\mu_1\)</span> celui des heommes. L’ordonnée à l’origine <span class="math inline">\(\beta_0\)</span> s’interprète comme d’ordinaire: c’est le salaire moyen quand <span class="math inline">\(\texttt{sexe}=0\)</span>, autrement dit <span class="math inline">\(\beta_0=\mu_0\)</span> puisque femme est la catégorie de référence ici. On peut écrire l’équation de la moyenne théorique conditionnelle pour chacune des catégories, <span class="math display">\[\begin{align*}
\mathsf{E}(\texttt{salaire} \mid \texttt{sexe})= \begin{cases}
\beta_0, &amp; \texttt{sexe}=0 \text{ (femme)}, \\
\beta_0 + \beta_1 &amp; \texttt{sexe}=1 \text{ (homme)}.
\end{cases}
\end{align*}\]</span> Un modèle linéaire qui contient uniquement une variable binaire <span class="math inline">\(\mathrm{X}\)</span> comme régresseur équivaut à spécifier une moyenne différente pour deux groupes; la moyenne des femmes est <span class="math inline">\(\mathsf{E}(\texttt{salaire} \mid \texttt{sexe}=1) = \beta_0 + \beta_1 = \mu_1\)</span> et <span class="math inline">\(\beta_1=\mu_1-\mu_0\)</span> représente la différence entre la moyenne des hommes et celles des femmes. L’estimateur des moindres carrés <span class="math inline">\(\widehat{\beta}_0\)</span> est la moyenne empirique du salaire des hommes de l’échantillon et <span class="math inline">\(\widehat{\beta}_1\)</span> est la différence des moyennes empiriques entre femmes et hommes.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/fig-graphcollegesexe_0c387dabd784c5c51147bba6977e3730">
<div class="cell-output-display">
<div id="fig-graphcollegesexe" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rappel-regressionlineaire_files/figure-html/fig-graphcollegesexe-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;9.4: Modèle linéaire simple pour les données <span class="math inline">\(\texttt{salaireprof}\)</span> en fonction de la variable binaire sexe: bien que le modèle définisse une ligne, seule la valeur en <span class="math inline">\(0\)</span> et <span class="math inline">\(1\)</span> est réalisable.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/unnamed-chunk-10_4f6046396d65ec4575700c2e21dd7e53">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Catégorie de base: femme (première en ordre alphanumérique)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(salaireprof<span class="sc">$</span>sexe)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "femme" "homme"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients du modèle: moyenne des femmes et différentiel homme vs ref</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(salaire <span class="sc">~</span> sexe, <span class="at">data =</span> salaireprof))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   sexehomme 
  101.00241    14.08801 </code></pre>
</div>
</div>
<p>Si on ajuste un modèle de régression linéaire pour les données <code>salaireprof</code>, on obtient un salaire moyen de <span class="math inline">\(\widehat{\beta}_0=1.01002\times 10^{5}\)</span> dollars USD pour les femmes et une différence moyenne de salaire entre hommes et femmes de <span class="math inline">\(\widehat{\beta}_1=-1.4088\times 10^{4}\)</span> dollars US. Puisque l’estimé est positif, les femmes sont moins payés: ce modèle n’est en revanche pas suffisant pour déterminer s’il y a inéquité salariale: la <a href="#fig-droitenuage">Figure&nbsp;<span>9.2</span></a> montre que le nombre d’années de service et l’échelon académique impactent fortement le salaire, or il n’est pas dit que la répartition des sexes au sein des échelons est comparable (et ce n’est pas le cas).</p>
<p>Même si le modèle linéaire simple définit une droite, cette dernière n’a de sens qu’en <span class="math inline">\(0\)</span> ou <span class="math inline">\(1\)</span>; la <a href="#fig-graphcollegesexe">Figure&nbsp;<span>9.4</span></a> montre un estimé de la densité et la répartition des points (décalés) dans l’échantillon selon le sexe, avec la moyenne de chacun. On voit bien que la droite passe par la moyenne de chaque groupe.</p>
<p>Plus généralement, il est possible de considérer une variable catégorielle à <span class="math inline">\(k\)</span> niveaux. Comme pour la variable binaire, on ajoute au modèle <span class="math inline">\(k-1\)</span> variables indicatrices en plus de l’ordonnée à l’origine: si on veut modéliser <span class="math inline">\(k\)</span> moyennes, il est logique de n’inclure que <span class="math inline">\(k\)</span> paramètres. On choisira comme dans l’exemple avec le sexe une <strong>catégorie de référence</strong> dont la moyenne sera encodée par l’ordonnée à l’origine <span class="math inline">\(\beta_0\)</span>. Les autres paramètres seront des effets différentiels relatifs à cette catégorie. Prenons pour exemple l’échelon académique, une variable catégorielle ordinale à trois niveaux (adjoint, aggrégé, titulaire). On ajoute deux variables binaires <span class="math inline">\(\mathrm{X}_1 = \mathsf{I}(\texttt{echelon}=\texttt{aggrege})\)</span> et <span class="math inline">\(\mathrm{X}_2 = \mathsf{I}(\texttt{echelon}=\texttt{titulaire})\)</span>; l’élément <span class="math inline">\(i\)</span> de la colonne <span class="math inline">\(\mathrm{X}_1\)</span> vaut 1 si le professeur est aggrégé et zéro autrement. Le modèle linéaire <span class="math display">\[\begin{align*}
\texttt{salaire} \mid \texttt{echelon}=\beta_0 + \beta_1 \mathrm{X}_1+\beta_2\mathrm{X}_2 + \varepsilon,
\end{align*}\]</span> et la moyenne théorique conditionnelle du salaire s’écrit <span class="math display">\[\begin{align*}
\mathsf{E}(\texttt{salaire} \mid \texttt{echelon})= \begin{cases}
\beta_0, &amp; \texttt{echelon}=\texttt{adjoint},\\
\beta_0 + \beta_1 &amp; \texttt{echelon}=\texttt{aggrege},\\
\beta_0 + \beta_2 &amp; \texttt{echelon}=\texttt{titulaire},
\end{cases}
\end{align*}\]</span> Ainsi, <span class="math inline">\(\beta_1\)</span> (respectivement <span class="math inline">\(\beta_2\)</span>) est la différence de salaire moyenne entre professeurs titulaires (respectivement aggrégés) et professeurs adjoints. Le choix de la catégorie de référence est arbitraire et le modèle ajusté est le même: seule l’interprétation des coefficients change. Pour une variable ordinale, il vaut mieux choisir la plus petite ou la plus grande des modalités pour faciliter les comparaisons.</p>
<p>Les modèles que nous avons ajusté jusqu’à maintenant ne sont pas adéquats parce qu’ils ignorent des variables qui sont importantes pour expliquer le modèle: la <a href="#fig-edacollege">Figure&nbsp;<span>9.1</span></a> illustre en effet que l’échelon est une composante essentielle pour expliquer les variations de salaire au sein du collège. On peut (et on doit) donc inclure plusieurs variables simultanément pour avoir un modèle adéquat. Avant de procéder, on considère l’interprétation des paramètres quand on utilise plus d’une variable explicative dans le modèle.</p>
<p>Soit le modèle <span class="math inline">\(Y= \beta_0 + \beta_1 \mathrm{X}_1 + \cdots + \beta_p\mathrm{X}_p + \varepsilon\)</span>. L’ordonnée à l’origine <span class="math inline">\(\beta_0\)</span> représente la valeur moyenne de <span class="math inline">\(Y\)</span> quand <em>toutes</em> les covariables du modèle sont égales à zéro, <span class="math display">\[\begin{align*}
\beta_0 &amp;= \mathsf{E}(Y \mid \mathrm{X}_1=0,\mathrm{X}_2=0,\ldots,\mathrm{X}_p=0).
\end{align*}\]</span> De nouveau, cette interprétation peut ne pas être sensée ou logique selon le contexte de l’étude. Le coefficient <span class="math inline">\(\beta_j\)</span> <span class="math inline">\((j \geq 1)\)</span> peut quant à lui être interprété comme l’augmentation moyenne de la moyenne théorique de la variable réponse <span class="math inline">\(Y\)</span> quand <span class="math inline">\(\mathrm{X}_j\)</span> augmente d’une unité, toutes choses étant égales par ailleurs (<em>ceteris paribus</em>). Le coefficient <span class="math inline">\(\beta_j\)</span> est donc la contribution <em>marginale</em> de <span class="math inline">\(\mathrm{X}_j\)</span> quand les autres covariables sont incluses dans le modèle. Par exemple, l’interprétation de <span class="math inline">\(\beta_1\)</span> est <span class="math display">\[\begin{align*}
\beta_1 &amp;= \mathsf{E}(Y \mid \mathrm{X}_1=x_1+1,\mathrm{X}_2=x_2,\ldots,\mathrm{X}_p=x_p) \\
&amp; \qquad \qquad - \mathsf{E}(Y \mid \mathrm{X}_1=x_1,\mathrm{X}_2=x_2,\ldots,\mathrm{X}_p=x_p) \\
&amp;= \left\{\beta_0 + \beta_1 (x_1+1) + \beta_2 x_2 + \cdots +\beta_p \mathrm{X}_p \right\} \\
&amp; \qquad \qquad -\left\{\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots +\beta_p \mathrm{X}_p \right\}
\end{align*}\]</span></p>
<section id="polynômes" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="polynômes"><span class="header-section-number">9.2.1</span> Polynômes</h3>
<p>Il n’est pas toujours possible de fixer la valeur des autres colonnes de <span class="math inline">\(\mathbf{X}\)</span> si plusieurs colonnes contiennent des transformations ou des fonctions d’une même variable explicative. Par exemple, on pourrait par exemple considérer un polynôme d’ordre <span class="math inline">\(k\)</span> (normalement, <span class="math inline">\(k\leq 3\)</span> en pratique), <span class="math display">\[\begin{align*}
Y=\beta_0+ \beta_1 \mathrm{X}+ \beta_2 \mathrm{X}^2 + \ldots +\beta_k \mathrm{X}^k + \varepsilon.
\end{align*}\]</span> Si l’on inclut un terme d’ordre <span class="math inline">\(k\)</span>, <span class="math inline">\(\mathrm{X}^k\)</span>, il faut <strong>toujours</strong> inclure les termes d’ordre inférieur <span class="math inline">\(1, \mathrm{X}, \ldots, \mathrm{X}^{k-1}\)</span> pour l’interprétabilité du modèle résultant (autrement, cela revient à choisir un polynôme en imposant que certains coefficients soient zéros). L’interprétation des effets des covariables nonlinéaires (même polynomiaux) est complexe parce qu’on ne peut pas « fixer la valeur des autres variables »: l’effet d’une augmentation d’une unité de <span class="math inline">\(\mathrm{X}\)</span> <em>dépend de la valeur de cette dernière</em>.</p>
<div id="exm-automobile" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 9.1 (Autonomie d’essence d’automobiles) </strong></span>Considérons un modèle de régression linéaire pour l’autonomie d’essence en fonction de la puissance du moteur pour différentes voitures dont les caractéristiques sont données dans le jeu de données <code>automobiles</code>. Le modèle postulé incluant un terme quadratique est <span class="math display">\[
\texttt{autonomie}_i = \beta_0 + \beta_1 \texttt{puissance}_i + \beta_2 \texttt{puissance}_i^2 + \varepsilon_i
\]</span></p>
<p>Afin de comparer l’ajustement du modèle quadratique, on peut inclure également la droite ajustée du modèle de régression simple qui n’inclut que puissance.</p>
<p><strong>Programmation</strong>: On peut ajouter plus d’une variable explicative dans un modèle de régression, en séparantles termes à droite du tilde avec des signes <code>+</code>. Si on veut ajouter le terme quadratique <code>x^2</code>, on peut faire la transformation en enrobant le tout avec <code>I()</code>, comme suit:</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/unnamed-chunk-11_bdf9694f16de0405d82b62b8c872201a">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(automobile, <span class="at">package =</span> <span class="st">"hecmodstat"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(autonomie <span class="sc">~</span> puissance <span class="sc">+</span> <span class="fu">I</span>(puissance<span class="sc">^</span><span class="dv">2</span>),  <span class="at">data =</span> automobile)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(autonomie <span class="sc">~</span> <span class="fu">poly</span>(puissance, <span class="at">degree =</span> <span class="dv">2</span>),  <span class="at">data =</span> automobile)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour inclure un polynôme de degré <span class="math inline">\(k\)</span> en <code>x</code>, on utilise l’argument <code>poly(x, degree = k)</code>. Attention cependant à l’interprétation (le modèle est spécifié, pour des raisons de stabilité numérique, à l’aide de polynôme orthogonaux — les valeurs prédites sont les mêmes, mais les coefficients ne représentent pas la même chose que si on avait <code>x</code>, <code>I(x^2)</code>, <code>I(x^3)</code>, etc.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/fig-autoquad2d_0ec39c326ada309c4c2c1a1c82ec6e90">
<div class="cell-output-display">
<div id="fig-autoquad2d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rappel-regressionlineaire_files/figure-html/fig-autoquad2d-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;9.5: Modèle de régression avec terme quadratique pour la puissance pour les données <code>automobile</code></figcaption>
</figure>
</div>
</div>
</div>
<p>À vue d’oeil, l’ajustement est meilleur pour le modèle quadratique: nous verrons plus tard à l’aide de test si cette observation est vérifiée statistiquement. On voit aussi dans la <a href="#fig-autoquad2d">Figure&nbsp;<span>9.5</span></a> que l’autonomie d’essence décroît rapidement quand la puissance croît entre <span class="math inline">\(0\)</span> et <span class="math inline">\(189.35\)</span>, mais semble remonter légèrement par la suite pour les voitures qui un moteur de plus de 200 chevaux-vapeurs, ce que le modèle quadratique capture. Prenez garde en revanche à l’extrapolation là où vous n’avez pas de données (comme l’illustre remarquablement bien <a href="https://livefreeordichotomize.com/2020/05/05/model-detective/">le modèle cubique de Hassett pour le nombre de cas quotidiens de coronavirus</a>).</p>
<p>La représentation graphique du modèle polynomial de degré 2 présenté dans la <a href="#fig-autoquad2d">Figure&nbsp;<span>9.5</span></a> peut sembler contre-intuitive, mais c’est une projection en 2D d’un plan 3D de coordonnées <span class="math inline">\(\beta_0 + \beta_1x-y +\beta_2z =0\)</span>, où <span class="math inline">\(x=\texttt{puissance}\)</span>, <span class="math inline">\(z=\texttt{puissance}^2\)</span> et <span class="math inline">\(y=\texttt{autonomie}\)</span>. La physique et le bon-sens imposent la contrainte <span class="math inline">\(z = x^2\)</span>, et donc les valeurs ajustées vivent sur une courbe dans un sous-espace du plan ajusté, représenté en gris dans la <a href="#fig-hyperplan">Figure&nbsp;<span>9.6</span></a>.</p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/fig-hyperplan_c6401678b5103077947cb2fb04fe7cc0">
<div id="fig-hyperplan" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-671815db35f2720a0e14" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-671815db35f2720a0e14">{"x":{"visdat":{"19b9d2d3e8522":["function () ","plotlyVisDat"],"19b9d68cc78ff":["function () ","data"]},"cur_data":"19b9d68cc78ff","attrs":{"19b9d2d3e8522":{"colors":"grey","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","name":"data","opacity":0.80000000000000004,"marker":{"color":"black","size":4,"hoverinfo":"skip","opacity":0.80000000000000004},"inherit":true},"19b9d2d3e8522.1":{"z":{},"type":"surface","x":[46,230],"y":[2116,52900],"name":"Relation entre puissance et autonomie","opacity":0.75,"cauto":false,"surfacecolor":[0,0,0],"inherit":false},"19b9d68cc78ff":{"colors":"grey","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"lines","color":["#003C71"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"puissance (chevaux vapeurs)"},"yaxis":{"title":"puissance carré"},"zaxis":{"title":"autonomie d'essence (miles au gallon)"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[130,165,150,150,140,198,220,215,225,190,170,160,150,225,95,95,97,85,88,46,87,90,95,113,90,215,200,210,193,88,90,95,100,105,100,88,100,165,175,153,150,180,170,175,110,72,100,88,86,90,70,76,65,69,60,70,95,80,54,90,86,165,175,150,153,150,208,155,160,190,97,150,130,140,150,112,76,87,69,86,92,97,80,88,175,150,145,137,150,198,150,158,150,215,225,175,105,100,100,88,95,46,150,167,170,180,100,88,72,94,90,85,107,90,145,230,49,75,91,112,150,110,122,180,95,100,100,67,80,65,75,100,110,105,140,150,150,140,150,83,67,78,52,61,75,75,75,97,93,67,95,105,72,72,170,145,150,148,110,105,110,95,110,110,129,75,83,100,78,96,71,97,97,70,90,95,88,98,115,53,86,81,92,79,83,140,150,120,152,100,105,81,90,52,60,70,53,100,78,110,95,71,70,75,72,102,150,88,108,120,180,145,130,150,68,80,58,96,70,145,110,145,130,110,105,100,98,180,170,190,149,78,88,75,89,63,83,67,78,97,110,110,48,66,52,70,60,110,140,139,105,95,85,88,100,90,105,85,110,120,145,165,139,140,68,95,97,75,95,105,85,97,103,125,115,133,71,68,115,85,88,90,110,130,129,138,135,155,142,125,150,71,65,80,80,77,125,71,90,70,70,65,69,90,115,115,90,76,60,70,65,90,88,90,90,78,90,75,92,75,65,105,65,48,48,67,67,67,67,62,132,100,88,72,84,84,92,110,84,58,64,60,67,65,62,68,63,65,65,74,75,75,100,74,80,76,116,120,110,105,88,85,88,88,88,85,84,90,92,74,68,68,63,70,88,75,70,67,67,67,110,85,92,112,96,84,90,86,52,84,79,82],"y":[16900,27225,22500,22500,19600,39204,48400,46225,50625,36100,28900,25600,22500,50625,9025,9025,9409,7225,7744,2116,7569,8100,9025,12769,8100,46225,40000,44100,37249,7744,8100,9025,10000,11025,10000,7744,10000,27225,30625,23409,22500,32400,28900,30625,12100,5184,10000,7744,7396,8100,4900,5776,4225,4761,3600,4900,9025,6400,2916,8100,7396,27225,30625,22500,23409,22500,43264,24025,25600,36100,9409,22500,16900,19600,22500,12544,5776,7569,4761,7396,8464,9409,6400,7744,30625,22500,21025,18769,22500,39204,22500,24964,22500,46225,50625,30625,11025,10000,10000,7744,9025,2116,22500,27889,28900,32400,10000,7744,5184,8836,8100,7225,11449,8100,21025,52900,2401,5625,8281,12544,22500,12100,14884,32400,9025,10000,10000,4489,6400,4225,5625,10000,12100,11025,19600,22500,22500,19600,22500,6889,4489,6084,2704,3721,5625,5625,5625,9409,8649,4489,9025,11025,5184,5184,28900,21025,22500,21904,12100,11025,12100,9025,12100,12100,16641,5625,6889,10000,6084,9216,5041,9409,9409,4900,8100,9025,7744,9604,13225,2809,7396,6561,8464,6241,6889,19600,22500,14400,23104,10000,11025,6561,8100,2704,3600,4900,2809,10000,6084,12100,9025,5041,4900,5625,5184,10404,22500,7744,11664,14400,32400,21025,16900,22500,4624,6400,3364,9216,4900,21025,12100,21025,16900,12100,11025,10000,9604,32400,28900,36100,22201,6084,7744,5625,7921,3969,6889,4489,6084,9409,12100,12100,2304,4356,2704,4900,3600,12100,19600,19321,11025,9025,7225,7744,10000,8100,11025,7225,12100,14400,21025,27225,19321,19600,4624,9025,9409,5625,9025,11025,7225,9409,10609,15625,13225,17689,5041,4624,13225,7225,7744,8100,12100,16900,16641,19044,18225,24025,20164,15625,22500,5041,4225,6400,6400,5929,15625,5041,8100,4900,4900,4225,4761,8100,13225,13225,8100,5776,3600,4900,4225,8100,7744,8100,8100,6084,8100,5625,8464,5625,4225,11025,4225,2304,2304,4489,4489,4489,4489,3844,17424,10000,7744,5184,7056,7056,8464,12100,7056,3364,4096,3600,4489,4225,3844,4624,3969,4225,4225,5476,5625,5625,10000,5476,6400,5776,13456,14400,12100,11025,7744,7225,7744,7744,7744,7225,7056,8100,8464,5476,4624,4624,3969,4900,7744,5625,4900,4489,4489,4489,12100,7225,8464,12544,9216,7056,8100,7396,2704,7056,6241,6724],"z":[18,15,18,16,17,15,14,14,14,15,15,14,15,14,24,22,18,21,27,26,25,24,25,26,21,10,10,11,9,27,28,25,19,16,17,19,18,14,14,14,14,12,13,13,18,22,19,18,23,28,30,30,31,35,27,26,24,25,23,20,21,13,14,15,14,17,11,13,12,13,19,15,13,13,14,18,22,21,26,22,28,23,28,27,13,14,13,14,15,12,13,13,14,13,12,13,18,16,18,18,23,26,11,12,13,12,18,20,21,22,18,19,21,26,15,16,29,24,20,19,15,24,20,11,20,19,15,31,26,32,25,16,16,18,16,13,14,14,14,29,26,26,31,32,28,24,26,24,26,31,19,18,15,15,16,15,16,14,17,16,15,18,21,20,13,29,23,20,23,24,25,24,18,29,19,23,23,22,25,33,28,25,25,26,27,17.5,16,15.5,14.5,22,22,24,22.5,29,24.5,29,33,20,18,18.5,17.5,29.5,32,28,26.5,20,13,19,19,16.5,16.5,13,13,13,31.5,30,36,25.5,33.5,17.5,17,15.5,15,17.5,20.5,19,18.5,16,15.5,15.5,16,29,24.5,26,25.5,30.5,33.5,30,30.5,22,21.5,21.5,43.100000000000001,36.100000000000001,32.799999999999997,39.399999999999999,36.100000000000001,19.899999999999999,19.399999999999999,20.199999999999999,19.199999999999999,20.5,20.199999999999999,25.100000000000001,20.5,19.399999999999999,20.600000000000001,20.800000000000001,18.600000000000001,18.100000000000001,19.199999999999999,17.699999999999999,18.100000000000001,17.5,30,27.5,27.199999999999999,30.899999999999999,21.100000000000001,23.199999999999999,23.800000000000001,23.899999999999999,20.300000000000001,17,21.600000000000001,16.199999999999999,31.5,29.5,21.5,19.800000000000001,22.300000000000001,20.199999999999999,20.600000000000001,17,17.600000000000001,16.5,18.199999999999999,16.899999999999999,15.5,19.199999999999999,18.5,31.899999999999999,34.100000000000001,35.700000000000003,27.399999999999999,25.399999999999999,23,27.199999999999999,23.899999999999999,34.200000000000003,34.5,31.800000000000001,37.299999999999997,28.399999999999999,28.800000000000001,26.800000000000001,33.5,41.5,38.100000000000001,32.100000000000001,37.200000000000003,28,26.399999999999999,24.300000000000001,19.100000000000001,34.299999999999997,29.800000000000001,31.300000000000001,37,32.200000000000003,46.600000000000001,27.899999999999999,40.799999999999997,44.299999999999997,43.399999999999999,36.399999999999999,30,44.600000000000001,33.799999999999997,29.800000000000001,32.700000000000003,23.699999999999999,35,32.399999999999999,27.199999999999999,26.600000000000001,25.800000000000001,23.5,30,39.100000000000001,39,35.100000000000001,32.299999999999997,37,37.700000000000003,34.100000000000001,34.700000000000003,34.399999999999999,29.899999999999999,33,33.700000000000003,32.399999999999999,32.899999999999999,31.600000000000001,28.100000000000001,30.699999999999999,25.399999999999999,24.199999999999999,22.399999999999999,26.600000000000001,20.199999999999999,17.600000000000001,28,27,34,31,29,27,24,36,37,31,38,36,36,36,34,38,32,38,25,38,26,22,32,36,27,27,44,32,28,31],"type":"scatter3d","mode":"markers","name":"data","opacity":0.80000000000000004,"marker":{"color":"black","size":4,"hoverinfo":"skip","opacity":0.80000000000000004,"line":{"color":"rgba(31,119,180,1)"},"showscale":false},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"autonomie<br />surf","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(190,190,190,1)"],["1","rgba(190,190,190,1)"]],"showscale":false,"z":[[38.059191113772322,-47.719700796540657],[100.5507364554749,14.771844545161926]],"type":"surface","x":[46,230],"y":[2116,52900],"name":"Relation entre puissance et autonomie","opacity":0.75,"cauto":false,"surfacecolor":[0,0,0],"frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0,1,4,9,16,25,36,49,64,81,100,121,144,169,196,225,256,289,324,361,400,441,484,529,576,625,676,729,784,841,900,961,1024,1089,1156,1225,1296,1369,1444,1521,1600,1681,1764,1849,1936,2025,2116,2209,2304,2401,2500,2601,2704,2809,2916,3025,3136,3249,3364,3481,3600,3721,3844,3969,4096,4225,4356,4489,4624,4761,4900,5041,5184,5329,5476,5625,5776,5929,6084,6241,6400,6561,6724,6889,7056,7225,7396,7569,7744,7921,8100,8281,8464,8649,8836,9025,9216,9409,9604,9801,10000,10201,10404,10609,10816,11025,11236,11449,11664,11881,12100,12321,12544,12769,12996,13225,13456,13689,13924,14161,14400,14641,14884,15129,15376,15625,15876,16129,16384,16641,16900,17161,17424,17689,17956,18225,18496,18769,19044,19321,19600,19881,20164,20449,20736,21025,21316,21609,21904,22201,22500,22801,23104,23409,23716,24025,24336,24649,24964,25281,25600,25921,26244,26569,26896,27225,27556,27889,28224,28561,28900,29241,29584,29929,30276,30625,30976,31329,31684,32041,32400,32761,33124,33489,33856,34225,34596,34969,35344,35721,36100,36481,36864,37249,37636,38025,38416,38809,39204,39601,40000,40401,40804,41209,41616,42025,42436,42849,43264,43681,44100,44521,44944,45369,45796,46225,46656,47089,47524,47961,48400,48841,49284,49729,50176,50625,51076,51529,51984,52441,52900,53361,53824,54289,54756,55225,55696,56169,56644,57121,57600,58081,58564,59049,59536,60025,60516,61009,61504,62001,62500],"z":[56.900099702112968,56.435140608266387,55.972642586621355,55.51260563717787,55.055029759935941,54.599914954895553,54.147261222056706,53.697068561419421,53.249336972983677,52.804066456749474,52.361257012716827,51.920908640885727,51.483021341256169,51.047595113828166,50.614629958601711,50.184125875576804,49.756082864753438,49.330500926131627,48.907380059711357,48.486720265492636,48.06852154347547,47.652783893659851,47.239507316045774,46.828691810633245,46.420337377422264,46.014444016412838,45.611011727604946,45.210040510998617,44.811530366593828,44.415481294390588,44.021893294388896,43.630766366588752,43.242100510990156,42.855895727593108,42.472152016397608,42.090869377403656,41.712047810611253,41.335687316020397,40.961787893631083,40.590349543443317,40.221372265457106,39.854856059672443,39.490800926089321,39.129206864707754,38.770073875527736,38.413401958549258,38.059191113772322,37.707441341196947,37.358152640823114,37.011325012650836,36.666958456680106,36.325052972910918,35.98560856134327,35.648625221977177,35.31410295481264,34.982041759849636,34.652441637088195,34.325302586528288,34.000624608169936,33.678407702013132,33.358651868057876,33.041357106304169,32.726523416752002,32.414150799401391,32.104239254252327,31.796788781304805,31.491799380558838,31.189271052014412,30.889203795671541,30.591597611530215,30.296452499590437,30.0037684598522,29.713545492315518,29.425783596980388,29.140482773846802,28.857643022914758,28.577264344184265,28.299346737655327,28.023890203327923,27.750894741202078,27.480360351277781,27.212287033555029,26.946674788033818,26.683523614714161,26.422833513596057,26.16460448467949,25.908836527964478,25.655529643451015,25.404683831139099,25.156299091028725,24.910375423119902,24.666912827412631,24.425911303906901,24.187370852602726,23.951291473500095,23.717673166599013,23.486515931899476,23.25781976940149,23.031584679105052,22.807810661010155,22.586497715116813,22.36764584142502,22.151255039934775,21.937325310646067,21.725856653558917,21.516849068673316,21.310302555989253,21.106217115506745,20.904592747225784,20.705429451146369,20.508727227268505,20.314486075592189,20.122705996117421,19.933386988844195,19.746529053772523,19.5621321909024,19.380196400233814,19.200721681766787,19.023708035501304,18.849155461437373,18.67706395957498,18.507433529914142,18.340264172454855,18.175555887197106,18.013308674140912,17.853522533286267,17.696197464633169,17.541333468181609,17.388930543931608,17.238988691883154,17.091507912036239,16.946488204390882,16.803929568947069,16.663832005704805,16.526195514664082,16.391020095824917,16.258305749187297,16.128052474751218,16.000260272516694,15.874929142483715,15.752059084652288,15.631650099022409,15.51370218559406,15.398215344367276,15.285189575342038,15.174624878518348,15.066521253896209,14.960878701475615,14.857697221256569,14.756976813239056,14.658717477423107,14.562919213808705,14.469582022395848,14.378705903184542,14.290290856174785,14.204336881366572,14.120843978759897,14.03981214835478,13.961241390151212,13.885131704149195,13.811483090348723,13.740295548749799,13.671569079352423,13.605303682156581,13.541499357162301,13.480156104369563,13.421273923778379,13.364852815388744,13.310892779200657,13.259393815214111,13.210355923429105,13.163779103845663,13.119663356463761,13.078008681283414,13.038815078304609,13.002082547527358,12.967811088951649,12.936000702577481,12.906651388404867,12.879763146433802,12.855335976664286,12.833369879096324,12.813864853729903,12.796820900565031,12.782238019601692,12.770116210839916,12.760455474279688,12.753255809921008,12.748517217763876,12.746239697808292,12.746423250054256,12.749067874501748,12.754173571150808,12.761740340001417,12.771768181053574,12.784257094307272,12.799207079762525,12.816618137419319,12.836490267277654,12.858823469337544,12.88361774359899,12.910873090061976,12.940589508726518,12.972766999592601,13.007405562660232,13.044505197929396,13.084065905400131,13.126087685072406,13.170570536946229,13.217514461021601,13.266919457298521,13.318785525776988,13.37311266645699,13.429900879338554,13.489150164421666,13.550860521706326,13.615031951192528,13.681664452880284,13.750758026769574,13.822312672860427,13.896328391152821,13.97280518164677,14.05174304434226,14.133141979239305,14.217001986337891,14.303323065638018,14.392105217139701,14.483348440842931,14.577052736747717,14.673218104854044,14.771844545161926,14.872932057671349,14.976480642382299,15.082490299294818,15.190961028408893,15.301892829724508,15.415285703241665,15.531139648960377,15.649454666880644,15.770230757002437,15.893467919325786,16.019166153850691,16.147325460577136,16.277945839505136,16.411027290634692,16.546569813965775,16.684573409498412,16.825038077232591,16.967963817168339,17.113350629305614,17.261198513644459],"type":"scatter3d","mode":"lines","marker":{"color":"rgba(0,60,113,1)","line":{"color":"rgba(0,60,113,1)"},"showscale":false},"textfont":{"color":"rgba(0,60,113,1)"},"error_y":{"color":"rgba(0,60,113,1)"},"error_x":{"color":"rgba(0,60,113,1)"},"line":{"color":"rgba(0,60,113,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly",".hideLegend":true},"evals":[],"jsHooks":[]}</script>
<figcaption class="figure-caption">Figure&nbsp;9.6: Représentation graphique 3D du modèle de régression linéaire pour les données d’automobiles.</figcaption>
</figure>
</div>
</div>
</div>
<div id="exm-inequite-salariale" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 9.2 (Inéquité salariale dans un collège américain”) </strong></span>On considère les données <code>salaireprof</code> et un modèle de régression qui inclut le sexe, l’échelon académique, le nombre d’années de service et le domaine d’expertise (appliquée ou théorique).</p>
<p>Si on multiplie le salaire par mille, la moyenne théorique de notre modèle linéaire s’écrit <span class="math display">\[\begin{align*}
\mathsf{E}(\texttt{salaire} \times 1000) &amp;= \beta_0 + \beta_1 \texttt{sexe}_{\texttt{femme}} +\beta_2 \texttt{domaine}_{\texttt{theorique}} \\&amp;\quad +\beta_3 \texttt{echelon}_{\texttt{aggrege}}
+\beta_4 \texttt{echelon}_{\texttt{titulaire}}  \\&amp;+\beta_5 \texttt{service}.
\end{align*}\]</span></p>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/tbl-collegecoefs_535c2a235a7b74ce4f097347ec4d8aed">
<div class="cell-output-display">
<div id="tbl-collegecoefs" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;9.2: Estimés des coefficients du modèle linéaire pour les données <span class="math inline">\(\texttt{salaireprof}\)</span> (en dollars USD, arrondis à l’unité).</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\beta}_0\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\beta}_1\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\beta}_2\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\beta}_3\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\beta}_4\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\beta}_5\)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">86596</td>
<td style="text-align: right;">-4771</td>
<td style="text-align: right;">-13473</td>
<td style="text-align: right;">14560</td>
<td style="text-align: right;">49160</td>
<td style="text-align: right;">-89</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-hash="rappel-regressionlineaire_cache/html/unnamed-chunk-15_f629542910c5093fd5629f9c00f6d79e">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>modlin2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(salaire <span class="sc">~</span>  sexe <span class="sc">+</span> domaine <span class="sc">+</span> echelon <span class="sc">+</span> service,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> salaireprof)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modlin2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = salaire ~ sexe + domaine + echelon + service, data = salaireprof)

Residuals:
    Min      1Q  Median      3Q     Max 
-64.202 -14.255  -1.533  10.571  99.163 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       86.59629    2.96031  29.252  &lt; 2e-16 ***
sexefemme         -4.77125    3.87800  -1.230 0.219311    
domainetheorique -13.47338    2.31550  -5.819 1.24e-08 ***
echelonaggrege    14.56040    4.09832   3.553 0.000428 ***
echelontitulaire  49.15964    3.83449  12.820  &lt; 2e-16 ***
service           -0.08878    0.11164  -0.795 0.426958    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 22.65 on 391 degrees of freedom
Multiple R-squared:  0.4478,    Adjusted R-squared:  0.4407 
F-statistic: 63.41 on 5 and 391 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>L’interprétation des coefficients est la suivante:</p>
<pre><code>                                                                                    - L'ordonnée à l'origine $\beta_0$ correspond au salaire moyen d'une professeure adjointe (une femme) qui vient de compléter ses études et qui travaille dans un domaine appliqué: on estime ce salaire à $\widehat{\beta}_0=8.6596\times 10^{4}$ dollars.</code></pre>
<ul>
<li>toutes choses étant égales par ailleurs (même domaine, échelon et années depuis le dernier diplôme), l’écart de salaire entre une femme et un homme est estimé à <span class="math inline">\(\widehat{\beta}_1=-4771\)</span> dollars.</li>
<li><em>ceteris paribus</em>, un(e) professeur(e) qui oeuvre dans un domaine théorique gagne <span class="math inline">\(\beta_2\)</span> dollars de plus qu’une personne du même sexe dans un domaine appliqué; on estime cette différence à <span class="math inline">\(-1.3473\times 10^{4}\)</span> dollars.</li>
<li><em>ceteris paribus</em>, la différence moyenne de salaire entre professeurs adjoints et aggrégés est estimée à <span class="math inline">\(\widehat{\beta}_3=1.456\times 10^{4}\)</span> dollars.</li>
<li><em>ceteris paribus</em>, la différence moyenne de salaire entre professeurs adjoints et titulaires est de <span class="math inline">\(\widehat{\beta}_4=4.916\times 10^{4}\)</span> dollars.</li>
<li>au sein d’un même échelon, chaque année supplémentaire de service mène à une augmentation de salaire annuelle moyenne de <span class="math inline">\(\widehat{\beta}_5=-89\)</span> dollars.</li>
</ul>
<p>On voit que les femmes sont moins payées que les hommes: reste à savoir si cette différence est statistiquement significative. L’estimé de la surprime annuelle due à l’expérience est négative, un résultat contre-intuitif au vu de la <a href="#fig-droitenuage">Figure&nbsp;<span>9.2</span></a> qui montrait une augmentation notable du salaire avec les années. Cette représentation graphique est trompeuse: la <a href="#fig-edacollege">Figure&nbsp;<span>9.1</span></a> montrait l’impact important de l’échelon académique. Une fois tous les autres facteurs pris en compte, le nombre d’années de service n’apporte que peu d’information au modèle; les gens avec un grand nombre d’années de service sont moins payés que certains de leurs collègues, ce qui explique la pente négative.</p>
</div>
</section>
</section>
<section id="budget-pour-lestimation" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="budget-pour-lestimation"><span class="header-section-number">9.3</span> Budget pour l’estimation</h2>
<p>Si on veut construire un modèle de régression avec un petit jeux de données, il faudra se demander si on a suffisamment d’information à disposition pour estimer de manière stable les coefficients. On voudra d’ordinaire que le nombre de lignes <span class="math inline">\(n\)</span> excède par au moins un facteur 10 le nombre de coefficients pour la moyenne, disons <span class="math inline">\(p\)</span>, mais c’est une règle du pouce arbitraire. Vous pouvez considérer que votre budget pour estimer chaque coefficient est donné par le rapport <span class="math inline">\(n/p\)</span>, et que la moyenne empirique quand on a uniquement une poignée ou deux d’observations est plus variable.</p>
<p>Si on considère une variable explicative catégorielle avec <span class="math inline">\(k\)</span> niveaux, les estimations des <span class="math inline">\(k\)</span> paramètres <span class="math inline">\(\beta\)</span> pour la moyenne (en incluant l’ordonnée à l’origine) sont simplement les moyennes de chaque sous-groupe, lesquelles seront plus ou moins précises selon le nombre d’observations <span class="math inline">\(n\)</span> dans chacun desdits groupes. Ainsi, il faut non seulement <span class="math inline">\(n\)</span> grand, mais on doit s’assurer que chaque niveau a suffisamment d’observations.</p>
<p>Quand on inclut des interactions, qui sont des nouvelles colonnes formées par le produit (typiquement) de variables catégorielles avec des variables continues (une pente pour chaque modalité de la variable catégorielle), ou des variables catégorielles (ce qui revient à créer un nouveau facteur avec un niveau pour chaque sous-catégorie), on se trouve rapidement avec de très petits groupes. Il peut être ainsi judicieux de fusionner certaines catégories trop peu peuplées ou d’éviter l’ajout de ces interactions sans considération pratique pour supporter ce choix.</p>
<p>C’est particulièrement le cas lorsque vous incluez une valeurs extrême ou une aberration dans un petit groupe. Le coefficient correspondant sera très fortement impacté et vous permettra peut-être de réduire l’erreur quadratique moyenne, mais cette amélioration ne se généralisera pas à de nouveaux échantillons et risque de biaiser vos prédictions.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Formellement, on parle d’espérance conditionnelle, ou moyenne théorique, en supposant que les valeurs des variables explicatives <span class="math inline">\(\mathbf{X}\)</span> sont exogènes, ou connues d’avance: l’inférence est faite conditionnellement à ces valeurs.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./references.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Références</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Tous droits réservés (Denis Larocque, Léo Belzile)</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>