<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="MATH 60602 - Analyse multidimensionnelle appliquée, HEC Montréal.">

<title>MATH 60602 - Analyse multidimensionnelle appliquée - 8&nbsp; Données manquantes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./regroupements.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="site_libs/bsTable-3.3.7/bootstrapTable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./donneesmanquantes.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Données manquantes</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MATH 60602 - Analyse multidimensionnelle appliquée</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/lbelzile/math60602/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./MATH60602.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyseexploratoire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analyse exploratoire</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./selectionmodeles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sélection de variables et de modèles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reglogistique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Régression logistique</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analyse de survie</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysefactorielle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Réduction de la dimension</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regroupements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Analyse de regroupements</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./donneesmanquantes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Données manquantes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#principes-de-base" id="toc-principes-de-base" class="nav-link active" data-scroll-target="#principes-de-base"><span class="header-section-number">8.1</span> Principes de base</a></li>
  <li><a href="#méthodes-dimputation" id="toc-méthodes-dimputation" class="nav-link" data-scroll-target="#méthodes-dimputation"><span class="header-section-number">8.2</span> Méthodes d’imputation</a>
  <ul class="collapse">
  <li><a href="#cas-complets" id="toc-cas-complets" class="nav-link" data-scroll-target="#cas-complets"><span class="header-section-number">8.2.1</span> Cas complets</a></li>
  <li><a href="#imputation-simple" id="toc-imputation-simple" class="nav-link" data-scroll-target="#imputation-simple"><span class="header-section-number">8.2.2</span> Imputation simple</a></li>
  <li><a href="#imputation-multiple" id="toc-imputation-multiple" class="nav-link" data-scroll-target="#imputation-multiple"><span class="header-section-number">8.2.3</span> Imputation multiple</a></li>
  </ul></li>
  <li><a href="#example-dapplication-de-limputation" id="toc-example-dapplication-de-limputation" class="nav-link" data-scroll-target="#example-dapplication-de-limputation"><span class="header-section-number">8.3</span> Example d’application de l’imputation</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/lbelzile/math60602/edit/master/donneesmanquantes.qmd" class="toc-action">Éditer cette page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="donnees-manquantes" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Données manquantes</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Il arrive fréquemment d’avoir des valeurs manquantes dans notre échantillon. Ces valeurs peuvent être manquantes pour diverses raisons. Si on prélève nous-mêmes nos données, un répondant peut refuser de répondre à certaines questions. Si on acquiert nos données d’une source externe, les valeurs de certaines variables peuvent être manquantes directement dans le fichier obtenu. Si on ne prend pas en compte le méchanisme générant les valeurs manquantes, ces dernières peuvent également biaiser nos analyses. Le but de ce chapitre est de faire un bref survol de ce sujet.</p>
<section id="principes-de-base" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="principes-de-base"><span class="header-section-number">8.1</span> Principes de base</h2>
<p>Soit <span class="math inline">\(X\)</span> une variable pour laquelle des données sont manquantes. Voici la définition de trois processus de génération de données manquantes.</p>
<ol type="1">
<li>Les données manquantes de <span class="math inline">\(X\)</span> sont dites <strong>manquantes de façon complètement aléatoire</strong> (MCAR, de l’anglais <em>missing completely at random</em>) si la probabilité que la valeur de <span class="math inline">\(X\)</span> soit manquante ne dépend ni de la valeur de <span class="math inline">\(X\)</span> (qui n’est pas observée), ni des valeurs des autres variables.</li>
</ol>
<p>Le fait qu’une variable est manquante peut être relié au fait qu’une autre soit manquante. Des gens peuvent refuser systématiquement de répondre à deux questions dans un sondage. Dans ce cas, si la probabilité qu’une personne ne réponde pas ne dépend pas des valeurs de ces variables (et de toutes les autres), nous sommes encore dans le cas MCAR. Si par contre, la probabilité que les gens ne répondent pas à une question sur leur revenu augmente avec la valeur de ce revenu, alors nous ne sommes plus dans le cas MCAR.</p>
<p>Le cas MCAR peut se présenter par exemple si des questionnaires, ou des pages ont été égarés ou détruits par inadvertance (effacées du disque rigide, etc.) Si les questionnaires manquants constituent un sous-ensemble choisi au hasard de tous les questionnaires, alors le processus est MCAR. L’hypothèse que les données manquantes sont complètement aléatoires est en général considérée comme trop restrictive.</p>
<ol start="2" type="1">
<li>Les données manquantes de <span class="math inline">\(X\)</span> sont dites <strong>données manquantes de façon aléatoire</strong> (MAR, de l’anglais <em>missing at random</em>) si la probabilité que la valeur de <span class="math inline">\(X\)</span> soit manquante ne dépend pas de la valeur de <span class="math inline">\(X\)</span> (qui n’est pas observée) une fois qu’on a contrôlé pour les autres variables.</li>
</ol>
<p>Il est possible par exemple que les femmes refusent plus souvent que les hommes de répondre à une question, par exemple de donner leur âge (et donc, le processus n’est pas MCAR). Si pour les femmes et les hommes, la probabilité que <span class="math inline">\(X\)</span> est manquante ne dépend pas de la valeur de <span class="math inline">\(X\)</span>, alors le processus est MAR. Les probabilités d’avoir une valeur manquante sont différentes pour les hommes et les femmes mais cette probabilité ne dépend pas de la valeur de <span class="math inline">\(X\)</span> elle-même. L’hypothèse MAR est donc plus faible que l’hypothèse MCAR.</p>
<ol start="3" type="1">
<li>Les données manquantes de <span class="math inline">\(X\)</span> sont dites <strong>manquantes de façon non-aléatoire</strong> (MNAR, de l’anglais <em>missing not at random</em>) si la probabilité que la valeur de <span class="math inline">\(X\)</span> soit manquante dépend de la valeur de <span class="math inline">\(X\)</span> elle-même.</li>
</ol>
<p>Par exemple, les gens qui ont un revenu élevé pourraient avoir plus de réticences à répondre à une question sur leur revenu. Un autre exemple est si une personne transgenre ne répond pas à la question genre (si on offre seulement deux choix, homme/femme) et aucune autre question ne se rattache au genre ou à l’identité sexuelle. La méthode de traitement que nous allons voir dans ce chapitre, l’imputation multiple, est très générale et est valide dans le cas MAR (et donc aussi dans le cas MCAR). Le cas MNAR est beaucoup plus difficile à traiter et ne sera pas considéré ici.</p>
<p>Il n’est pas possible de tester l’hypothèse que le données sont manquantes de façon aléatoire ou complètement aléatoire; ce postulat doit donc être déterminé à partir du contexte et des variables auxiliaires disponibles.</p>
</section>
<section id="méthodes-dimputation" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="méthodes-dimputation"><span class="header-section-number">8.2</span> Méthodes d’imputation</h2>
<p>Il est important de noter que, dans bien des cas, les données manquantes ont une valeur logique: un client qui n’a pas de carte de crédit a un solde de 0! Tous ces cas devraient être traités en amon, d’où l’importance des validations d’usage et du nettoyage préliminaire de la base de données.</p>
<section id="cas-complets" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="cas-complets"><span class="header-section-number">8.2.1</span> Cas complets</h3>
<p>La première idée naïve pour une analyse est de retirer les observations avec données manquantes pour conserver les cas complets (<em>listwise deletion</em>, ou <em>complete case analysis</em>).</p>
<p>Cette méthode consiste à garder seulement les observations qui n’ont aucune valeur manquante pour les variables utilisées dans l’analyse demandée. Dès qu’une variable est manquante, on enlève le sujet au complet. C’est la méthode utilisée par défaut dans la plupart des logiciels, dont <strong>R</strong>.</p>
<ul>
<li>Si le processus est MCAR, cette méthode est valide car l’échantillon utilisé est vraiment un sous-échantillon aléatoire de l’échantillon original. Par contre, ce n’est pas nécessairement la meilleure solution car on perd de la précision en utilisant moins d’observations.</li>
<li>Si le processus est seulement MAR ou MNAR, cette méthode produit généralement des estimations biaisées des paramètres.</li>
</ul>
<p>En général, l’approche des cas complet est la première étape d’une analyse afin d’obtenir des estimés initiaux que nous corrigerons pas d’autre méthode. Elle n’est vraiment utile que si la proportion d’observations manquantes est très faible et le processus est MCAR. Évidemment, la présence de valeurs manquantes mène à une diminution de la précision des estimateurs (caractérisée par une augmentation des erreurs-types) et à une plus faible puissance pour les tests d’hypothèse et donc ignorer l’information partielle (si seulement certaines valeurs des variables explicatives sont manquantes) est sous-optimal.</p>
</section>
<section id="imputation-simple" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="imputation-simple"><span class="header-section-number">8.2.2</span> Imputation simple</h3>
<p>L’<strong>imputation</strong> consiste à remplacer les valeurs manquantes pour boucher le trous. Pour paraphraser Dempster et Rubin (1983),</p>
<blockquote class="blockquote">
<p>Le concept d’imputation est à la fois séduisant et dangereux.</p>
</blockquote>
<p>Avec l’<strong>imputation simple</strong>, on remplace les valeurs manquantes par des ersatz raisonnables. Par exemple, on peut remplacer les valeurs manquantes d’une variable par la moyenne de cette variable dans notre échantillon. On peut aussi ajuster un modèle de régression avec cette variable comme variable dépendante et d’autres variables explicatives comme variables indépendantes et utiliser les valeurs prédites comme remplacement. Une fois que les valeurs manquantes ont été remplacées, on fait l’analyse avec toutes les observations.</p>
<p>L’imputation par le mode ou la moyenne n’est pas recommandée parce qu’elle dilue la corrélation entre les variables explicatives et elle réduit la variabilité. Les modèles de régression mènent également à une-sous estimation de l’incertitude en raison cette fois-ci de l’augmentation de la corrélation, ce qui augmente mécaniquement la significativité des tests, contrairement à l’imputation aléatoire (droite). Le <a href="#fig-imputation">Figure&nbsp;<span>8.1</span></a> montre clairement cet état de fait.</p>
<div class="cell" data-layout-align="center" data-hash="donneesmanquantes_cache/html/fig-imputation_567a7a0b3fe6fbd7bed600414e407dcf">
<div class="cell-output-display">
<div id="fig-imputation" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="donneesmanquantes_files/figure-html/fig-imputation-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.1: Différences entre méthodes d’imputation, avec imputation par la moyenne, par le biais d’une régression linéaire et par un modèle aléatoire de régression, de gauche à droite.</figcaption>
</figure>
</div>
</div>
</div>
<p>En quoi constitue l’imputation aléatoire recommandée ci-dessus? Considérons le cas d’une régression logistique pour une variable explicative binaire. Plutôt que d’assigner à la classe la plus probable, une prédiction aléatoire simule une variable 0/1 avec probabilité <span class="math inline">\((1-\widehat{p}_i, \widehat{p}_i)\)</span>. Pour un modèle de régression linéaire par moindres carrés ordinaires avec vecteur ligne de prédicteurs <span class="math inline">\(\mathbf{x}_i\)</span> et matrice de modèle <span class="math inline">\(\mathbf{X}\)</span>, la prédiction sera tirée de la loi prédictive normale<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>Il existe d’autres façons d’imputer les valeurs manquantes mais le problème de toutes ces approches est que l’on ne tient pas compte du fait que des valeurs ont été remplacées et on fait comme si c’était de vraies observations. Cela va en général sous-évaluer la variabilité dans les données. Par conséquent, les écarts-type des paramètres estimés seront en général sous-estimés et l’inférence (tests et intervalles de confiance) ne sera pas valide. Cette approche n’est donc <strong>pas recommandée</strong>.</p>
<p>Une manière de tenter de reproduire correctement la variabilité dans les données consiste à ajouter un terme aléatoire dans l’imputation. C’est ce que fait la méthode suivante, qui possédera l’avantage de corriger automatiquement les écarts-type des paramètres estimés.</p>
</section>
<section id="imputation-multiple" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="imputation-multiple"><span class="header-section-number">8.2.3</span> Imputation multiple</h3>
<p>Cette méthode peut être appliquée dans à peu près n’importe quelle situation et permet d’ajuster les écarts-type des paramètres estimés. Elle peut être appliquée lorsque le processus est MAR (et donc aussi MCAR).</p>
<p>L’idée consiste à procéder à une imputation aléatoire, selon une certaine technique, pour obtenir un échantillon complet et à ajuster le modèle d’intérêt avec cet échantillon. On répète ce processus plusieurs fois et on combine les résultats obtenus.</p>
<div class="cell" data-layout-align="center" data-hash="donneesmanquantes_cache/html/unnamed-chunk-3_45835b4b535806e15546683955a575c8">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/donnees_manquantes_workflow.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>L’estimation finale des paramètres du modèle est alors simplement la moyenne des estimations pour les différentes répétitions et on peut également obtenir une estimation des écarts-type des paramètres qui tient compte du processus d’imputation.</p>
<p>Plus précisément, supposons qu’on s’intéresse à un seul paramètre <span class="math inline">\(\theta\)</span> dans un modèle donné. Ce modèle pourrait être un modèle de régression linéaire, de régression logistique, etc. Le paramètre <span class="math inline">\(\theta\)</span> serait alors un des <span class="math inline">\(\boldsymbol{\beta}\)</span> du modèle.</p>
<p>Supposons qu’on procède à <span class="math inline">\(K\)</span> imputations, c’est-à-dire, qu’on construit <span class="math inline">\(K\)</span> ensemble de données complets à partir de l’ensemble de données initial contenant des valeurs manquantes. On estime alors les paramètres du modèle séparément pour chacun des ensembles de données imputés. Soit <span class="math inline">\(\widehat{\theta}_k\)</span>, l’estimé du paramètre <span class="math inline">\(\theta\)</span> pour l’échantillon <span class="math inline">\(k \in \{1, \ldots, K\}\)</span> et <span class="math inline">\(\widehat{\sigma}_k^2=\mathsf{Va}(\widehat{\theta}_k)\)</span> l’estimé de la variance de <span class="math inline">\(\widehat{\theta}_k\)</span> produite par le modèle estimé.</p>
<p>L’estimation finale de <span class="math inline">\(\theta\)</span>, dénotée <span class="math inline">\(\widehat{\theta}\)</span>, est obtenue tout simplement en faisant la moyenne des estimations de tous les modèles, c’est-à-dire, <span class="math display">\[\begin{align*}
\widehat{\theta} = \frac{\widehat{\theta}_1 + \cdots + \widehat{\theta}_K}{K}.
\end{align*}\]</span> Une estimation ajustée de la variance de <span class="math inline">\(\widehat{\theta}\)</span> est <span class="math display">\[\begin{align*}
\mathsf{Va}(\hat{\theta}) &amp;= W+ \frac{K+1}{K}B,
\\ W &amp;= \frac{1}{K} \sum_{k=1}^K \widehat{\sigma}^2_k = \frac{\widehat{\sigma}_1^2 + \cdots + \widehat{\sigma}_K^2}{K},\\
B &amp;= \frac{1}{K-1} \sum_{k=1}^K (\widehat{\theta}_k - \widehat{\theta})^2.
\end{align*}\]</span> Ainsi, le terme <span class="math inline">\(W\)</span> est la moyenne des variances et <span class="math inline">\(B\)</span> est la variance entre les imputations. Le terme <span class="math inline">\((1+1/K)B\)</span> est celui qui vient corriger le fait qu’on travaille avec des données imputées et non pas des vraies données en augmentant la variance estimée du paramètre.</p>
<p>C’est ici qu’on voit l’intérêt à procéder à de l’imputation multiple. Si on procédait à une seule imputation (même en ajoutant une part d’aléatoire pour essayer de reproduire la variabilité des données), on ne serait pas en mesure d’estimer la variance inter-groupe de l’estimateur. Notez que la formule présentée n’est valide que pour le cas unidimensionnel; l’estimation de la variance dans le cas multidimensionnel est différente <span class="citation" data-cites="Little.Rubin:2019">(<a href="references.html#ref-Little.Rubin:2019" role="doc-biblioref">Little and Rubin 2019</a>)</span>.</p>
<p>Il faut également ajuster les formules pour le calcul des intervalles de confiance, valeurs-<span class="math inline">\(p\)</span> et degrés de liberté. Le logiciel s’en chargera pour nous.</p>
<p>La méthode d’imputation multiple possède l’avantage d’être applicable avec n’importe quel modèle sous-jacent. Une fois qu’on a des échantillons complets (imputés), on ajuste le modèle comme d’habitude. Mais une observation imputée ne remplacera jamais une vraie observation. Il faut donc faire tout ce qu’on peut pour limiter le plus possible les données manquantes.</p>
<p>Il faut utiliser son jugement. Par exemple, si la proportion d’observations perdues est petite (moins de 5%), ça ne vaut peut-être pas la peine de prendre des mesures particulières et on peut faire une analyse avec les données complètes seulement. S’il y a un doute, on peut faire une analyse avec les données complètes seulement et une autre avec imputations multiples afin de valider la première.</p>
<p>Si, à l’inverse, une variable secondaire cause à elle seule une grande proportion de valeurs manquantes, on peut alors considérer l’éliminer afin de récupérer des observations. Par exemple, si vous avez une proportion de 30% de valeurs manquantes en utilisant toutes vos variables et que cette proportion baisse à 3% lorsque vous éliminez quelques variables peu importantes pour votre étude (ou qui peuvent être remplacées par d’autres jouant à peu près le même rôle qui elles sont disponibles), alors vous pourriez considérer la possibilité de les éliminer. Il est donc nécessaire d’examiner la configuration des valeurs manquantes avant de faire quoi que ce soit.</p>
<p>Pour l’imputation, nous utiliserons l’algorithme d’imputation multiple par équations chaînées (MICE).</p>
<p>Avec <span class="math inline">\(p\)</span> variables <span class="math inline">\(X_1, \ldots, X_p\)</span>, spécifier un ensemble de modèles <strong>conditionnels</strong> pour chaque variable <span class="math inline">\(X_j\)</span> en fonction de toutes les autres variables, <span class="math inline">\(\boldsymbol{X}_{-j}\)</span> et les valeurs observées pour cette variable, <span class="math inline">\(X_{j, \text{obs}}\)</span>.</p>
<p>L’idée est de remplir aléatoire tous les trous et ensuite d’utiliser des modèles d’imputation aléatoire pour chaque variable à tour de rôle. Après plusieurs cycles où chacune des variables explicatives (au plus le nombre de colonnes <span class="math inline">\(p\)</span>) est imputée, l’impact de l’initialisation devrait être faible. On retourne alors une copie de la base de données.</p>
<ol type="1">
<li>Initialisation: remplir les trous avec des données au hasard parmi <span class="math inline">\(X_{j, \text{obs}}\)</span> pour <span class="math inline">\(X_{j, \text{man}}\)</span></li>
<li>À l’itération <span class="math inline">\(t\)</span>, pour chaque variable <span class="math inline">\(j=1, \ldots, p\)</span>, à tour de rôle:
<ol type="a">
<li>tirage aléatoire des paramètres <span class="math inline">\(\phi_j^{(t)}\)</span> du modèle pour <span class="math inline">\(X_{j,\text{man}}\)</span> conditionnel à <span class="math inline">\(\boldsymbol{X}_{-j}^{(t-1)}\)</span> et <span class="math inline">\(X_{j, \text{obs}}\)</span></li>
<li>échantillonnage de nouvelles observations <span class="math inline">\(X^{(t)}_{j,\text{man}}\)</span> du modèle avec paramètres <span class="math inline">\(\phi_j^{(t)}\)</span> conditionnel à <span class="math inline">\(\boldsymbol{X}_{-j}^{(t-1)}\)</span> et <span class="math inline">\(X_{j, \text{obs}}\)</span></li>
</ol></li>
<li>Répéter le cycle</li>
</ol>
</section>
</section>
<section id="example-dapplication-de-limputation" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="example-dapplication-de-limputation"><span class="header-section-number">8.3</span> Example d’application de l’imputation</h2>
<p>On examine l’exemple de recommandations de l’association professionnelle des vachers de la section <a href="reglogistique.html#sec-cowboy"><span>Section&nbsp;4.2.3</span></a>.</p>
<p>Le but est d’examiner les effets des variables <span class="math inline">\(X_1\)</span> à <span class="math inline">\(X_6\)</span> sur les intentions d’achat; la base de données <code>manquantes</code> contient les observations. Il s’agit des mêmes données que celles du fichier <code>logit1</code> mais avec des valeurs manquantes.</p>
<div class="cell" data-hash="donneesmanquantes_cache/html/tbl-missing1r_ad2c3b1b8b307830232014b739a08443">
<div class="cell-output-display">
<div id="tbl-missing1r" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tableau&nbsp;8.1: Tableau de la configuration des données manquantes.</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">\(X_1\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(X_2\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(X_3\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(X_4\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(X_5\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(X_6\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(y\)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">.</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">.</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">.</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">.</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">.</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Les points (<code>.</code>) indiquent des valeurs manquantes. Le premier sujet n’a pas de valeur manquante. Le deuxième a une valeur manquante pour <span class="math inline">\(X_1\)</span> (emploi) et <span class="math inline">\(X_4\)</span> (éducation), etc.</p>
<p>Une première façon de voir combien il y a de valeurs manquantes consiste à faire sortir les statistiques descriptives avec <code>summary</code>. Ainsi, il y 192 valeurs manquantes pour <span class="math inline">\(X_1\)</span>, 48 pour <span class="math inline">\(X_2\)</span> et 184 pour <span class="math inline">\(X_4\)</span>. Les autres variables n’ont pas de valeurs manquantes, incluant la variable dépendante <span class="math inline">\(Y\)</span>. La procédure unidimensionnelle nous permet seulement de voir combien il y a de valeurs manquantes variable par variable.</p>
<div class="cell" data-hash="donneesmanquantes_cache/html/tbl-manquantes-univ_ff41391bd28525d716ae9608067193a5">
<div class="cell-output-display">
<div id="tbl-manquantes-univ" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tableau&nbsp;8.2: Pourcentage de valeurs manquantes par variable.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x4</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x5</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x6</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">nombre</td>
<td style="text-align: left;">192</td>
<td style="text-align: left;">49</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">184</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pourcentage</td>
<td style="text-align: left;">0.384</td>
<td style="text-align: left;">0.098</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.368</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-hash="donneesmanquantes_cache/html/manquantes-summary-uni_ec8cfe1c47c730272857d6d699144b9e">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(manquantes, <span class="at">package =</span> <span class="st">'hecmulti'</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manquantes)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentage de valeurs manquantes</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(manquantes, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">mean</span>(<span class="fu">is.na</span>(x))})</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Voir les configurations de valeurs manquantes</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">md.pattern</span>(manquantes)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous utiliserons le paquet <strong>R</strong> <code>mice</code> pour faire l’imputation.</p>
<ol type="1">
<li>Procéder à plusieurs imputations <strong>aléatoires</strong> pour obtenir un échantillon complet (<code>mice</code>)</li>
<li>Ajuster le modèle d’intérêt avec chaque échantillon (<code>with</code>). 3. Combiner les résultats obtenus (<code>pool</code> et <code>summary</code>)</li>
</ol>
<div class="cell" data-hash="donneesmanquantes_cache/html/fig-manquantes2_e8bc4ba72a39f239faa868f4f05e7c7d">
<div class="cell-output-display">
<div id="fig-manquantes2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="donneesmanquantes_files/figure-html/fig-manquantes2-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.2: Configurations des valeurs manquantes pour la base de données <code>manquantes</code>.</figcaption>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-manquantes2">Figure&nbsp;<span>8.2</span></a> donne une indication sur les différentes combinaisons de données complètes (cases bleues) et les observations manquantes (cases roses) avec leur fréquence. Les variables sont indiquées au dessus, les effectifs manquants en dessous, le nombre de cas de chaque combinaisons à gauche et le nombre de variables avec des valeurs manquantes à droite. Ainsi, il y a 180 sujets (36% de l’échantillon) avec aucune observation manquante. Il y en a 99 avec seulement <span class="math inline">\(X_4\)</span> manquante et ainsi de suite. On voit donc, par exemple, que pour 14 sujets, à la fois <span class="math inline">\(X_1\)</span> et <span class="math inline">\(X_2\)</span> sont manquantes.</p>
<p>La recommandation d’usage est d’imputer au moins le pourcentage de cas incomplet, ici 64% donc 64 imputations. Si la procédure est trop coûteuse en calcul, on peut diminuer le nombre d’imputations, mais il faut au minimum 10 réplications pour avoir une bonne idée de la variabilité.</p>
<p>On peut comparer l’inférence avec toutes les variables explicatives pour les données sans valeurs manquantes (<span class="math inline">\(n=500\)</span> observations), avec les cas complets uniquement (<span class="math inline">\(n=180\)</span> observations). Le <a href="#tbl-missing3r">Tableau&nbsp;<span>8.3</span></a> présente les estimations des paramètres du modèle de régression logistique s’il n’y avait pas eu de valeurs manquantes, avec les cas complets et les résultats de l’imputation multiple.</p>
<p>Si on ajuste un modèle à une base de données qui contient des valeurs manquantes, le comportement par défaut est de retirer les observations qui ont au moins une valeur manquante pour une des variables nécessaires à l’analyse (voir la sortie de <code>glm(y ~ ., data = manquantes)</code>). Il ne serait pas raisonnable de faire l’analyse avec seulement 180 observations et de laisser tomber les 320 autres. De plus, comme nous l’avons vu plus haut, ce n’est pas valide à moins que le processus ne soit MCAR. La partie du milieu du <a href="#tbl-missing3r">Tableau&nbsp;<span>8.3</span></a> présente les estimations obtenues. Plusieurs variables significatives à niveau <span class="math inline">\(\alpha=0.05\)</span> ne le sont plus (puisqu’il y a moins d’information quand on réduit le nombre d’observations). Il y a même pire: non seulement la variable <span class="math inline">\(\mathsf{I}(X_2=1)\)</span> est passée de significative à non significative, mais en plus l’estimé de son paramètre a changé de signe.</p>
<p>Nous allons donc faire l’analyse avec l’imputation multiple, en prenant la méthode d’imputation par défaut</p>
<div class="cell" data-hash="donneesmanquantes_cache/html/manquante2_8ac85e4a5416ec833e229b8d8339b8f4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation multiple avec équations enchaînées</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Intensif en calcul, réduire `m` si nécessaire</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>impdata <span class="ot">&lt;-</span> <span class="fu">mice</span>(<span class="at">data =</span> manquantes,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">m =</span> <span class="dv">50</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">2021</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Chaque copie est disponible (1, ..., 50)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">complete</span>(impdata, <span class="at">action =</span> <span class="dv">1</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ajuste les modèles avec les données imputées</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>adj_im <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> impdata,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">expr =</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'logit'</span>)))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># combinaison des résultats </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">pool</span>(adj_im)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La procédure <code>mice</code> du paquet éponyme crée les copies complètes du jeu de données. On peut ensuite appliquer une procédure quelconque et combiner les estimations avec <code>pool</code>.</p>
<div class="cell" data-hash="donneesmanquantes_cache/html/tbl-missing3r_01f037567049ee7e9f781a81d6ea5049">
<div class="cell-output-display">
<div id="tbl-missing3r" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tableau&nbsp;8.3: Estimés, erreurs-type et valeurs-p des paramètres avec les 500 données complètes (gauche), avec les 180 cas complets (milieu) et avec l’imputation multiple (droite).</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Données complètes
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cas complets
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Imputation multiple
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\boldsymbol{\beta}}\)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">\(\mathrm{se}(\widehat{\boldsymbol{\beta}})\)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">valeur-\(p\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\boldsymbol{\beta}}\)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">\(\mathrm{se}(\widehat{\boldsymbol{\beta}})\)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">valeur-\(p\)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">\(\widehat{\boldsymbol{\beta}}\)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">\(\mathrm{se}(\widehat{\boldsymbol{\beta}})\)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">valeur-\(p\)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cste</td>
<td style="text-align: right;">-6.89</td>
<td style="text-align: center;">1.02</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">-5.25</td>
<td style="text-align: center;">1.70</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">-6.57</td>
<td style="text-align: center;">1.04</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">\(x_1=1\)</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">0.46</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">0.92</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: center;">0.54</td>
<td style="text-align: center;">0.31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">\(x_1=2\)</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: center;">0.21</td>
<td style="text-align: right;">-0.57</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">0.39</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">0.78</td>
</tr>
<tr class="even">
<td style="text-align: left;">\(x_1=3\)</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: center;">0.35</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">0.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">\(x_1=4\)</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: center;">0.40</td>
<td style="text-align: center;">0.43</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: center;">0.74</td>
<td style="text-align: center;">0.21</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">0.93</td>
</tr>
<tr class="even">
<td style="text-align: left;">\(x_2=1\)</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: center;">0.60</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: right;">-0.74</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">0.52</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: center;">0.65</td>
<td style="text-align: center;">0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">\(x_2=2\)</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: center;">0.91</td>
<td style="text-align: center;">0.61</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: center;">0.55</td>
<td style="text-align: center;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">\(x_2=3\)</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">0.11</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.64</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: center;">0.52</td>
<td style="text-align: center;">0.31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">\(x_2=4\)</td>
<td style="text-align: right;">-1.11</td>
<td style="text-align: center;">0.54</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: right;">-2.74</td>
<td style="text-align: center;">1.02</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: right;">-1.04</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">\(x_3\)</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: center;">0.27</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">\(x_4\)</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: center;">0.30</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: center;">0.58</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">\(x_5\)</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">\(x_6=1\)</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: center;">0.38</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">2.26</td>
<td style="text-align: center;">0.38</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">\(x_6=2\)</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">0.00</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>On peut remarquer que la précision est systématiquement meilleure avec l’imputation multiple; les erreurs-type pour l’imputation multiple sont plus petits que celle du modèle qui retire les données incomplètes.</p>
<p>On voit que la variable <span class="math inline">\(X_3\)</span> (sexe) est significative avec l’imputation multiple. Son paramètre estimé est 1.19, comparativement à 1.349 s’il n’y avait pas eu de valeurs manquantes. La précision dans l’estimation avec l’imputation multiple est seulement un peu moins bonne (erreur-type de 0.27) que celle s’il n’y avait pas eu de manquantes (erreur type de 0.26). Le paramètre de <span class="math inline">\(\mathsf{I}(X_6=2)\)</span> redevient aussi significatif, alors qu’il ne l’était plus si on retirait les manquantes. Il est peu probable que les données soit <span class="math inline">\(\mathsf{MCAR}\)</span> et donc les résultats de l’analyse des cas complets seraient biaisés.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
En résumé
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Les données manquantes réduisent la quantité d’information disponible et augmentent l’incertitude.</li>
<li>On ne peut <strong>pas</strong> les ignorer (étude des cas complets) sans biaiser les interprétations et réduire la quantité d’information disponible.</li>
<li>Pour bien capturer l’incertitude et ne pas modifier les relations entre variables, il faut utiliser une méthode d’imputation aléatoire.</li>
<li>Avec l’algorithme MICE, on utilise un modèle conditionnel pour chaque variable à tour de rôle.</li>
<li>L’imputation multiple est préférée à l’imputation simple car elle permet d’estimer l’incertitude sous-jacente en raison des données manquantes.</li>
<li>Il faut un traitement spécial pour les erreurs-type, degrés de liberté, valeurs-<span class="math inline">\(p\)</span> et intervalles de confiance.</li>
</ul>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Little.Rubin:2019" class="csl-entry" role="listitem">
Little, Roderick J. A., and Donald B Rubin. 2019. <span>“Statistical Analysis with Missing Data.”</span> Edited by Wiley. <a href="https://doi.org/10.1002/9781119482260">https://doi.org/10.1002/9781119482260</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Spécifiquement, une loi normale avec moyenne <span class="math inline">\(\widehat{y}_i=\mathbf{x}_i\widehat{\boldsymbol{\beta}}\)</span> et variance <span class="math inline">\(\widehat{\sigma}^2\{\mathbf{x}_i\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{x}_i^\top + 1\}\)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./regroupements.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Analyse de regroupements</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">Références</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Tous droits réservés (Denis Larocque, Léo Belzile)</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>